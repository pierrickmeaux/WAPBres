
\def\anon{1} %% set to 1 for anonymous submissions, hides acknowledgements and author names
\def\full{1} %% set to 0 for springer proceedings


\ifnum\full=1
\documentclass[11pt]{llncs}


\addtolength{\parskip}{1pt}
\else
\documentclass[10pt, runningheads]{llncs}
\usepackage{times}
\fi


\input{header.tex}


\begin{document}


%\title{Notes: On the Resilience Order of Weightwise Almost Perfectly Balanced Functions}
\title{Notes: On the Resilience Order of W(A)PB Functions}


%\subtitle{}



	\titlerunning{On the Resilience Order of W(A)PB Functions}
	\author{
		\mbox{Pierrick M\'eaux\orcidID{0000-0001-5733-4341}}
	}

	\authorrunning{ P. M\'eaux}

	\institute{
University of Luxembourg, Luxembourg\\	\email{pierrick.meaux@uni.lu}
}






	%----------------------------------------------------------------
	\maketitle



 \setcounter{page}{1}

\begin{abstract}



%\keywords{Boolean functions, algebraic immunity, symmetric functions, HWBF}
\end{abstract}

\section{Introduction.}


\section{Preliminaries.}


We denote by $[1,n]$ the set of all integers from $1$ to $n$, \ie $\{1,\ldots,n\}$.
For readability, we use the notation $+$ instead of $\oplus$ for addition in $\F_2$.
For a vector $v \in \F_2^n$, we denote its Hamming weight by $\w(v)$, defined as $\w(v) = |\{ i \in [n] \mid v_i = 1 \}|$.
%For two vectors $v, w \in \F_2^n$, we denote their Hamming distance by $\hd(v,w)$, given by $\hd(v,w) = \w(v + w)$.
%Throughout this article, $\log$ denotes the base-2 logarithm.



%\subsection{Generalities on Boolean functions and cryptographic criteria}


%In this section, we review fundamental concepts of Boolean functions and define their key cryptographic properties.
%For a more in-depth discussion on Boolean functions and their cryptographic properties, we refer to the book~\cite{Carlet20}.


%\begin{definition}[Boolean Function]\label{def:bool_f}
%	A Boolean function $f$ in $n$ variables (an $n$-variable Boolean function) is a function from $\F_2^n$ to $\F_2$.
%	The set of all Boolean functions in $n$ variables is denoted by $\BN$.
%\end{definition}



%\begin{definition}[Algebraic Normal Form (ANF) and degree]\label{def:anf}
%	We call Algebraic Normal Form of a Boolean function $f$ its $n$-variable polynomial representation over $\F_2$ (\ie belonging to $\F_2[x_1,\dots,x_n]/(x_1^2+x_1,\dots,x_n^2+x_n)$):
%	\begin{align*}
%	f(x)= \sum_{I \subseteq [n]} a_I \left( \prod_{i \in I} x_i \right) =\sum_{I \subseteq [n]} a_I x^I,
%	\end{align*}
%	where $a_I\in \F_2$.
%	\begin{itemize}
%		\item The algebraic degree of $f$ is: $\degg(f)= \max_{\{I \; | \; a_I=1\}}|I|$ (with the convention that $\degg(0)=0$).
%		\item Any term $\prod_{i\in I}x_i$ in such an ANF is called a monomial and its degree equals $|I|$.
%	\end{itemize}
%\end{definition}


%\subsection{Cryptographic criteria of Boolean functions}


%In this article we study the algebraic immunity of various functions. In the following we give its definition, the algebraic immunity is entre autres used as the main parameter to estimate the complexity of the algebraic attack~\cite{EC:CouMei03} for filtered linear shift back register. Then we recall the concept of balancedness and nonlinearity that are the other main cryptographic criteria to consider for a Boolean function used in a stream cipher.



%\begin{definition}[Algebraic Immunity, ~\cite{EC:MeiPasCar04}] \label{def:ai}
%	The algebraic immunity of a Boolean function $f\in \BN$, denoted as $\AI(f)$, is defined as:
%	\[ \AI(f) = \min_{g \neq 0}\{ \degg(g) \; | \; fg = 0 \; \text{or} \; (f + 1)g = 0 \}{,} \]
%	where $\degg(g)$ is the algebraic degree of $g$.
%	The function $g$ is called an annihilator of $f$ (or $f + 1$).
	%	Additionally we denote $\AN(f) = \min_{g \neq 0}\{ \degg(g) \; | \; fg = 0\}$.
%\end{definition}



%\begin{definition}[Balancedness]\label{def:balancedness}
%	A Boolean function $f\in \BN$
%	is said to be balanced if and only if $|\supp(f)|=|\supp(f+1)|=2^{n-1}$,
%	where the support of $f$ denotes the set $\{x \in \F_2^n, \text{ such that } f(x)=1\}$.
%\end{definition}

%\begin{definition}[Nonlinearity] \label{def:nl}
%	The nonlinearity $\NL (f)$ of a Boolean function $f\in \BN$, where $n$ is a positive integer, is the minimum Hamming distance between $f$ and all the affine functions in $\BN$:
%	\[ \NL(f) = \min_{g,\, \degg(g)\leq 1} \{ d_H(f,g) \}{,} \]
%	with $d_H(f,g) = \#\{ x \in \F_2^n \;|\; f(x) \neq g(x) \}$ the Hamming distance between $f$ and $g$, and $g(x)=a\cdot x+\varepsilon$; $a\in \F_2^n, \varepsilon\in \F_2$ (where $\cdot$ is an inner product in $\F_2^n$).
%\end{definition}



\subsection{Boolean functions and cryptographic properties}

\begin{definition}[Balancedness]\label{def:balancedness}
	A Boolean function $f\in \Bn{n}$ is said to be balanced if $|\supp(f)|=2^{n-1}=|\supp(f+1)|$, where $\supp(f)$ denotes the support of $f$, the set $\{x\in \F_2^n \mid f(x)=1\}$.
\end{definition}


\begin{definition}[Walsh transform ]\label{def:walsh_transform}
	Let $f\in \Bn{n}$ be a Boolean function, its Walsh transform $\wt{f}$ at $a \in \F_2^n$ is defined as:
	\[  \wt{f} (a) = \sum_{x \in \F_2^n} (-1)^{f(x) +  a \cdot x },\]
	where $a \cdot x$ denotes the inner product.
\end{definition}

\begin{definition}[Resilience]\label{def:res}
	A Boolean function $f\in \Bn{n}$ is said to be $t$-resilient if for all $a\in \F_2^n$ such that $0\le \w(a)\le t$ we have $\wt{f}(a)=0$.
\end{definition}

\begin{definition}[Corrector]\label{def:corr}
	A Boolean function $f\in \Bn{n}$ is said to be a $t$-corrector if for all $0\le k \le t$ it satisfies:
	\[\sum_{a\in \F_2^n \atop{\w(a)=k}} \wt{f}(a)=0.\]
\end{definition}


\subsection{Slices, restricted Walsh transform, and WAPB functions}




\begin{definition}[Slices of the Boolean hypercube]\label{def:slices}
	For $k \in [0,n]$, we define the $k$-th slice of the $n$-dimensional Boolean hypercube as the set $\Ekn{k}{n} = \{x \in \F_2^n \mid \w(x) = k\}$.
\end{definition}

According to Definition~\ref{def:slices}, the Boolean hypercube is partitioned into $n+1$ slices, where each slice consists of vectors sharing the same Hamming weight.
We refer to properties that hold slice-wise as weightwise properties.
The $n$-variable symmetric Boolean functions are precisely those that are constant on each slice.



\begin{definition}[Restricted Walsh transform]\label{def:restWalsh}
	Let $f\in \Bn{n}$, $S \subset \F_2^n$, its Walsh transform restricted to $S$ at $a \in \F_2^n$ is defined as:
	\[  \wt{f,S} (a) = \sum_{x\in S} (-1)^{f(x)+ax}.\]
	For $S=\Ekn{k}{n}$ we denote $\wt{f,\Ekn{k}{n}} (a)$ by $\wtk{f}{k}(a)$, and for $a= 0_{n}$ we denote $\wtk{f}{k}(a)$ as $\wtk{f}{k}$.

\end{definition}


\begin{definition}[Weightwise (Almost) Perfectly Balanced Function (WPB and WAPB)\cite{TOSC:CarMeaRot17}]\label{def:WPB}
	Let $m\in \N^*$ and $f$ be a Boolean function in $n=2^m$ variables. It will be called weightwise perfectly balanced (WPB) if, for every $k\in[1,n-1]$, $f$ is balanced on the slice $k$, that is $\forall k \in [1,n-1], |\suppk{k}(f)|=\binom{n}{k}/2$, and:
	\[f(0,\cdots,0)=0,\quad \text{ and } \quad f(1,\cdots,1)=1.\]
	The set of WPB functions in $2^m$ variables is denoted by $\WPB{m}$.

	%	When $n$ is not a power of $2$, some other weights than $k=0$ and $n$ give slices of odd cardinality, in this case we call $f\in \Bn{n}$ weightwise almost perfectly balanced (WAPB) if:
	When $n$ is not a power of $2$, some other weights than $k=0$ and $n$ give slices of odd cardinality. We consider the generalization for any $n\in \N^*$, in this case we call $f\in \Bn{n}$ weightwise almost perfectly balanced (WAPB) if:
	\[|\suppk{k}(f)|= \left \{
	\begin{array}{l l}
	|\Ekn{k}{n}|/2  & \text{ if } |\Ekn{k}{n}| \text{ is even, } \\
	(|\Ekn{k}{n}|\pm 1)/2  & \text{ if }  |\Ekn{k}{n}| \text{ is odd.}
	\end{array}\right.\]
	The set of WAPB functions in $n$ variables is denoted $\WAPB{n}$.

\end{definition}




\begin{Prop}[WAPB functions and restricted Walsh transform]\label{prop:WAPBWalsh}

	Let $n\in \N^*$, $f\in \Bn{n}$ is WAPB if and only if:
	\[\forall k \in [0,n], \, \wtk{f}{k}(0_n)=
	\left \{
	\begin{array}{l l}
	0  & \text{ if } |\Ekn{k}{n}| \text{ is even, } \\
	\pm 1 & \text{ if }  |\Ekn{k}{n}| \text{ is odd.}
	\end{array}\right. \]
	If $n=2^m$ with $m\in \N^*$, $f\in \Bn{n}$ is WPB if and only if:
	\[\wtk{f}{0}=1, \quad \wtk{f}{n}=-1, \text{ and } \quad \forall k \in [1,n-1] \,  \wtk{f}{k}=0. \]

\end{Prop}


\subsubsection{Krawtchouk polynomials.}
We use Krawtchouk polynomials and some of their properties to prove one of our results, we give the necessary preliminaries here and refer to \eg ~\cite{book:MacSlo78} for more details.

\begin{definition}[Krawtchouk Polynomials]\label{def:Kraw}
	The Krawtchouk polynomial of degree $k$, with $0\leq k\leq n$ is given by: $ \displaystyle \kraw{k}{\ell}{n}=\sum_{j=0}^{k} (-1)^j \binom{\ell}{j} \binom{n-\ell}{k-j}$.
	%	Krawtchouk polynomials are characterized by the generating series: $ \displaystyle (1+z)^{n-x} (1-z)^x=\sum_{k=0}^\infty \kraw{k}{x}{n} z^k$.
\end{definition}


\pmnote{add Lucas' theorem}



\begin{Prop}[Krawtchouk polynomials relation]\label{prop:Kr}
	Let $n\in \N^*$ and $k\in [0,n]$, the following hold:
\begin{itemize}
	\item $\kraw{k}{\ell}{n}$ is the value of the restricted Walsh transform on $\Ekn{k}{n}$ of any $n$ variable linear function $a\cdot \ell$ such that $\w(a)=\ell$,
	\item $\kraw{k}{n-\ell}{n}=(-1)^k \kraw{k}{\ell}{n}$,
	\item $\kraw{n-k}{x}{n}=(-1)^x \kraw{k}{x}{n}$,
		\item if $n$ is even and $k$ is odd, $\kraw{k}{n/2}{n}=0$,
	\item if $n$ is even, $\kraw{n/2}{1}{n}=0$.
	\item $\binom{n}{\ell}\kraw{k}{x}{n}=\binom{n}{k}\kraw{\ell}{k}{n}$.
	\end{itemize}
\end{Prop}



\begin{Prop}[Krawtchouk polynomials relation ~\cite{DCC:DalMaiSar06} Proposition $4$ Item $2$]\label{prop:KrDMS}
Let $n\in \N^*$ and $k\in [0,n]$, the following hold:
\[(k+1)\kraw{k+1}{\ell}{n}=(n-2\ell)\kraw{k}{\ell}{n}-(n-k+1)\kraw{k-1}{\ell}{n}.\]
\end{Prop}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{$t$-corrector and Restricted Walsh Transform}\label{sec:corr}



We rewrite the $t$-corrector property using the notation of restricted Walsh transform.

\begin{proposition}\label{prop:WalsCorr}
	Let $n\in \N^*$ and $t\in \N$ such that $t\le n$. A Boolean function $f\in \Bn{n}$ is a $t$-corrector if the following holds on its restricted Walsh transform:
	\begin{itemize}
		\item If $n$ is odd: for $0\le k \le t$,
		\[\sum_{a\in \Ekn{k}{n}} \wt{f}(a)=\sum_{\ell=0}^{(n-1)/2} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell})=0.\]
	\item If $n$ is even: for $0\le k \le t$,
		\[\sum_{a\in \Ekn{k}{n}} \wt{f}(a)=\wtk{f}{n/2} \, \kraw{k}{n/2}{n}+ \sum_{\ell=0}^{n/2-1} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell})=0.\]
	\end{itemize}




\end{proposition}
\begin{proof}

We denote by $A_k$ the quantity $A_k=\sum_{a\in \F_2^n \atop{\w(a)=k}} \wt{f}(a)$.
From Definition~\ref{def:corr}, $f$ is a $t$-corrector if $A_k=0$ for $k\in [0,t]$.
%\[A_k=\sum_{a\in \F_2^n \atop{\w(a)=k}} \wt{f}(a).\]
We rewrite $A_k$:
\begin{align*}
A_k&=\sum_{a\in \Ekn{k}{n}} \wt{f}(a)\\
&=\sum_{a\in \Ekn{k}{n}} \sum_{x\in \F_2^n} (-1)^{f(x)+a \cdot x}\\
&= \sum_{x\in \F_2^n} (-1)^{f(x)}  \left(\sum_{a\in \Ekn{k}{n}}(-1)^{a \cdot x}\right)\\
&=\sum_{\ell=0}^{n} \sum_{x\in \Ekn{\ell}{n}} (-1)^{f(x)}  \left(\sum_{a\in \Ekn{k}{n}}(-1)^{a \cdot x}\right)\\
&=\sum_{\ell=0}^{n} \sum_{x\in \Ekn{\ell}{n}} (-1)^{f(x)} \,  \kraw{k}{\ell}{n}\\
&=\sum_{\ell=0}^{n} \wtk{f}{\ell} \, \kraw{k}{\ell}{n}.
\end{align*}
Using Property~\ref{prop:Kr}, when $n$ is odd we obtain:
\[A_k=\sum_{\ell=0}^{(n-1)/2} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell}). \]
When $n$ is even we obtain:
\[A_k=\wtk{f}{n/2} \, \kraw{k}{n/2}{n}+ \sum_{\ell=0}^{n/2-1} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell}). \]
It allows to conclude.

\end{proof}




%\section{WPB functions and corrector order}
\section{Resilience order of WPB Functions}


\subsection{WPB functions are balanced and not $1$-resilient}
The reformulation of $t$-corrector is sufficient to show that WPB functions are $0$-corrector and not $1$-corrector, which also allows to status on their resilience order.

\begin{theorem}\label{thm:WPB}
	Let $m\in \N^*$ and $n=2^m$, if $f$ is an $n$-variable WPB function then $f$ is $0$-corrector, $f$ is not $1$-corrector, $f$ is $0$-resilient and not $1$-resilient.
\end{theorem}
\begin{proof}
	By definition (Definition~\ref{def:WPB}) a WPB function is balanced, hence $0$-corrector and $0$-resilient.
	To show that $f$ is not $1$-corrector we show the values of its restricted Walsh transform do not satisfy the characterization of Proposition~\ref{prop:WalsCorr}.

	Using Proposition~\ref{prop:WalsCorr} we have:
	\[\sum_{a\in \Ekn{1}{n}} \wt{f}(a)=\wtk{f}{n/2} \, \kraw{1}{n/2}{n}+ \sum_{\ell=0}^{n/2-1} \kraw{1}{\ell}{n} \, ( \wtk{f}{\ell} - \wtk{f}{n-\ell}).\]
	Since $f$ is WPB, using Property~\ref{prop:WAPBWalsh} we obtain:
	\[\sum_{a\in \Ekn{1}{n}} \wt{f}(a)=0+2\kraw{1}{0}{n}=2n\ne 0,\]
	hence $f$ is not $1$-corrector by Proposition~\ref{prop:WalsCorr}. Since $f$ is not $1$-corrector it implies $f$ is not $1$-resilient.

\end{proof}

We recall that the WAPB functions when $n=2^m$ are either of the form $f$ or $1+f$ with $f\in \WPB{m}$, hence all $2^m$-variable WAPB functions are $0$-resilient and not $1$-resilient.



\subsection{Correction order of WAPB functions in $n=2^{k_1} + 2^{k_2}$ variables}

We can extend the bound of the correction order to $\WAPB{n}$ when $\w(n)=2$, using the Krawtchouk polynomials of degree $2$.

\begin{proposition}\label{prop:WAPB2}
	Let $k_1<k_2\in \N$ and $n=2^{k_1}+2^{k_2}$, if $f$ is an $n$-variable WAPB function then $f$ is at most $1$-corrector and not $2$-resilient.
\end{proposition}
\begin{proof}
	From Proposition~\ref{prop:WalsCorr} $f$ is $1$-corrector if for $k=0$ and $k=1$:
	\begin{equation}\label{eq:wapb2}
	\sum_{\ell=0}^{n} \wtk{f}{\ell} \, \kraw{k}{\ell}{n}=0
	\end{equation}
	and $2$ corrector if additionally the same equation holds for $k=2$.

Using Property~\ref{prop:WAPBWalsh} the only restricted Walsh transform coefficient that are not null are the ones for $k\in\{0,2^{k_1},2^{k_2},2^{k_1}+2^{k_2}=n\}$. It allows to simplify Equation~\ref{eq:wapb2}:
	\begin{equation}\label{eq:wapb2simple}
a \kraw{k}{0}{n} + b \kraw{k}{2^{k_1}}{n} + c \kraw{k}{2^{k_2}}{n} + d \kraw{k}{n}{n}=0,
\end{equation}
where $a,b,c,d \in \{\pm 1\}^4$.

Since $ \kraw{0}{\ell}{n}=1$ for all $\ell$, Equation~\ref{eq:wapb2simple} for $k=0$ leads to the equation $a+b+c+d=0$, that is two of them equal $-1$ and two of them equal $1$.

Since $ \kraw{1}{\ell}{n}=n-2\ell$, Equation~\ref{eq:wapb2simple} for $k=1$ leads to the following equation:
\begin{equation*}
a n+b (n-2^{k_1+1}) +c (n-2^{k_2+1}) -d n=0,
\end{equation*}
equivalent to:
\begin{equation}\label{eq:wapb2simple2}
 (a-d+b+c) n= b 2^{k_1+1}) +c 2^{k_2+1}.
\end{equation}
We remark that if $a$ and $d$ have opposite sign, it implies $b$ and $c$ also to satisfy Equation~\ref{eq:wapb2simple}.
In this case, Equation~\ref{eq:wapb2simple2} becomes $\pm2n= \pm (2^{k_1+1} - 2^{k_2+1})$ which is impossible.
Nevertheless, if $a=d$ it implies $b=c=-a$ and in this case the equation becomes $\pm 2n = \pm (2^{k_1+1} + 2^{k_2+1})=\pm 2n$.
This shows that there exist $(2^{k_1}+2^{k_2})$-variable WAPB functions that are $1$-corrector.


Since $ \kraw{2}{\ell}{n}=\ell^2 -2 n \ell + \binom{n}{2}$, the solutions satisfying Equation~\ref{eq:wapb2simple2} lead to the following equation:
\begin{equation}\label{eq:wapb2simple3}
\pm \binom{n}{2} \mp \left(2^{2k_1} -2n2^{k_1} + \binom{n}{2} \right) \mp \left(2^{2k_2} -2n2^{k_2} + \binom{n}{2} \right) \pm \left(-n^2 + \binom{n}{2}\right)=0.
\end{equation}
Equation~\ref{eq:wapb2simple3} simplifies to:
%\[2^{2k_1} -2n2^{k_1} + 2^{2k_2} -2n2^{k_2} +n^2= 0 \]
\begin{align*}
0&=2^{2k_1} -2n2^{k_1} + 2^{2k_2} -2n2^{k_2} +n^2\\
&=2^{2k_1} + 2^{2k_2} -2n(2^{k_1}+2^{k_2}) +n^2 = 2^{2k_1} + 2^{2k_2} -n^2\\
&= -2^{k_1+k_2+1}.
\end{align*}
Since $-2^{k_1+k_2+1}$ cannot be null, there is no solution in $\{\pm1\}^4$ satisfying Equation~\ref{eq:wapb2} for all $k\in[0,2]$, hence there exists no $(2^{k_1}+2^{k_2})$-variable WAPB function that is $2$-corrector, nor $2$-resilient.



\end{proof}


\begin{remark}
We can see the proofs of Theorem~\ref{thm:WPB} and Proposition~\ref{prop:WAPB2} as particular cases of a more general result: \textit{Let $f$ be an $n$-variable WAPB function, then $f$ is at most $(\w(n)-1)$-corrector and cannot be $(\w(n))$-corrector}, where we prove it by considering relations on Krawtchouk polynomials of degree at most $\w(n)$.

Increasing the Hamming weight of one doubles the number of non null restricted Walsh transform coefficients and increases by one the degree of the last polynomial to consider, that is why we do not extend the proof strategy for $n$ of higher Hamming weights.
Regarding the resilience bound, we know that for all $n$ there exist WAPB functions with resilience order $\w(n)-1$: for example the ones obtained by direct sum of WPB functions in $2^{k_i}$ variables~\cite{DAM:ZhuSu22} when we write $n$ as $n=\sum_{i=1}^{\w(n)} 2^{k_i}$ where $k_1<\dots<k_{\w(n)}$.
Since these functions are the direct sum of $\w(n)$ balanced functions their resilience order is at least $\w(n)-1$.




\end{remark}





\section{WAPB Functions and Corrector Order}

\pmnote{proposed roadmap:

\begin{itemize}
	\item definitions to connect it to the matrix
	\item from Krawtchouk matrix to the powers
	\item solution for $\w(n)$-1, add link to PTE problem. add note on the existing WAPB that hare $\w(n)-1$-resilient.
\end{itemize}
}

Reformulation.

\begin{definition}\label{def:restWalshVect}
Let $n\in \N^*$ and $f\in \BN$, we define its restricted Walsh vector, denoted by $\rwv{f}$, in $\Z^{n+1}$ as:
\[\rwv{f}=(\wtk{f}{0},\wtk{f}{1},\cdots,\wtk{f}{n-1},\wtk{f}{n})\]

\end{definition}


\begin{definition}\label{def:KrMat}
	Let $n\in \N^*$ and $k\in \N$ such that $k\le n$, we define the Krawchouk matrix
	$\KrM{n}{k}\in 	\Z^{(n+1)\times (k+1)}$ as:
	\[\forall i \in [0,n], j\in [0,k], \quad \KrM{n}{k}_{i,j}=\kraw{j}{i}{n}.\]

\end{definition}

With these notations, using the development of Proposition~\ref{prop:WalsCorr} we get that $f$ is a $t$-corrector if and only if:
\[\rwv{f} \cdot \KrM{n}{t}=0_t.\]

For a WAPB function $f$, we have $\rwv{f}\in \{-1,0,1\}^{n+1}$ from Property~\ref{prop:WAPBWalsh}. Moreover, since the number of nonzero values corresponds to the odd parity of the associate binary coefficient, we have $\w(\rwv{f})=2^{\w(n)}$, and the non null coefficients are the ones such that $k\preceq n$.


We can prove that for $\w(n)=1$ (the case of WPB functions) the WAPB functions cannot be $1$-corrector
(that is $\rwv{f} \cdot \KrM{n}{1}$
$\neq 0_2$), and for
 $\w(n)=2$
  (the case of WAPB functions in $2^r +2^s$ variables) the WAPB functions
 cannot be $2$-corrector (that is $\rwv{f} \cdot \KrM{n}{2} \ne 0_3$).
We would like to prove or disprove that $n$-variable WAPB functions are not $\w(n)$-corrector.

The results for $\w(n)=1$ and $\w(n)=2$ comes from the value of the matrix $\KrM{n}{n}$, but could we deduce more knowing that the matrix is invertible?



\pmnote{

 WAPB in $n$ variable have $2^\w(n)$ restricted Walsh values that belongs to $\{-1,1\}$.


  So far the best resilience order known for a WAPB function is $\w(n)-1$.
}



\subsection{Notes on the proposition}

Let us ave a look on the expression of an integer at the power $r$ when we write it in binary:
\[a^r=(\sum_{i=1}^{t} b_i 2^{k_i})^r\]
If we develop this expression we can rewrite it as a multivariate polynomial in the $b_i$.
I give the example for $t=2$:
\[a^0=1, \quad a^1= b_1 2^{k_1}+ b_2 2^{k_2},\quad a^2= b_1 2^{2k_1} + b_1 b_2 2\cdot  2^{k_1+k_2} + b_2 2^{2k_2}.\]

The expression will make appear all combinations of the $b_i$ having between $1$ and $r$ $b_i$s. Each one of these monomials of degree between $1$ and $r$ is associated to a coefficient, say $c_b$.

Then, when we consider the $-1$ and $+1$ combinations to obtain $0$, it means we split $\F_2^t$ in two sets of size $2^{t-1}$, $S_1$ and $S_2$ such that:
\[\sum_{b\in S_1} (\sum_{i=1}^{t} b_i 2^{k_i})^r =  \sum_{b\in S_2} (\sum_{i=1}^{t} b_i 2^{k_i})^r.\]

We can verify that when $t<r$, taking $S_1$ as the set of vectors of odd Hamming weight and $S_2$ the set of vectors of even Hamming weight each term $c_b$ appears the same number of times in each sum: the monomials of degree between $1$ and $r$ are equal to $1$ the same number of times over $S_1$ than over $S_2$. It is sufficient to guarantee the equality of the two sums.

When $t=r$, the situation changes: there is the monomial of degree $t$: $\prod_{i=1}^t b_i$, and this one takes the value $1$ only for one element: $1_t$. For all other monomials, they take the value $1$ on the same number of elements in $S_1$ than in $S_2$.
Accordingly, the two sums differ from a term $c_{1_t}$.

This explain why taking $S_1$ and $S_2$ as odd and even Hamming weight element work to create $t-1$-corrector that are not $t$-corrector.
I am not sure it allows to conclude they do not exist: we could do another partition of $\F_2^t$ as $S_1$ and $S_2$ such that $|S_1|=|S_2|$ where we compensate the $c_b$s. We have that $c_{1_t}$ will appear only once, so in only one of the two sums, the total number of terms appearing is odd when $r=t$.










\newpage

\subsection*{A note on the problem}

For a positive integer $n$ of Hamming weight $t\geq 2$, we denote by $supp(n)$ the set of nonzero coordinates in the binary expansion of $n$.
For two positive integers $n, m$, we denote by $m\preceq n$ when $supp(m) \subseteq supp(n)$, and by $m\prec n$ if $supp(m) \subset supp(n)$.

Given a positive integer $n$ with $supp(n) = \{i_1,\dots, i_t\}$, where $i_1<\dots<i_t$, we need to show that the system of equations
\[
\sum_{k \preceq n } v_k k^u = 0, \quad  u=0,\dots, r
\] has solutions $(v_0,\dots, v_n)\in \{\pm 1\}^{2^t}$ for $r=t-1$ and has no solution for $r=t$.

\begin{lemma}\label{Represention_Equations}
	For $1\leq u \leq t$, the equation $\sum_{k \preceq n } v_k k^u = 0$ can be re-written as
	\begin{equation}\label{key}
	\sum_{s=1}^t\sum\limits_{\substack{\{j_1,\dots, j_s\} \subseteq [t] \\ u_{j_1}+\cdots+ u_{j_s}=u \\  u_{j_1},\dots,u_{j_s}\geq 1}}  \frac{u!}{u_1!\cdots u_s!} \left(  \sum_{\substack{\{i_{j_1},\dots, i_{j_s}\} \subseteq supp(k)   \\ k\preceq n }}  v_k \right)  x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}},
	\end{equation} where $[t]$ denotes the set $\{1,2,\dots, t\}$.
\end{lemma}

\textbf{Proof.} Note that the expansion of $(x_1+\cdots + x_s)^u$ is given by
\[
(x_1+\cdots + x_s)^u = \sum\limits_{\substack{u_1+\cdots + u_s = u\\ u_1,\dots, u_s\geq 0}} \frac{u!}{u_1!\cdots u_s!}x_1^{u_1}\dots x_s^{u_s},
\] where $ \frac{u!}{u_1!\cdots u_s!}$ is the multinomial coefficient.
In the above sum $(u_1,\dots, u_s)$ can be seen as a non-negative partition of the integer $u$. For simplicity, we denote by $P_s(u)$ the set of all such partitions of $u$.
Observe that for any $(u_1,\dots, u_s)\in P_s(u)$, the integers $u_1,\dots, u_s, 0$ form an $(s+1)$-tuple in $P_{s+1}(u)$. This implies the inclusive relation
$$
P_s(u) \subset P_{s+1}(u), quad s = 1, 2, \dots.
$$
%This indicates that all terms in the sum $(x_1+\cdots + x_s)^u = \sum_{(u_1,\dots, u_s)\in P_s(u)} x_1^{u_1}\dots x_s^{u_s}$
%are included in the sum $(x_1+\cdots + x_s+x_{s+1})^u = \sum_{(u_1,\dots, u_s,u_{s+1})\in P_{s+1}(u)} x_1^{u_1}\dots x_s^{u_s}x_{s+1}^{u_{s+1}}$.
%For instance, take $u=2$ and $s=2$, one has $$\begin{array}{c}
%(x_1+x_2)^2 = {2 \choose 2,0}x_1^2x_2^0 +{2 \choose 0,2}x_1^0x_2^2 + {2 \choose 1,1}x_1^1x_2^1 = x_1^2 + x_2^2 + 2x_1x_2 \end{array}$$
%and
%$$
%\begin{aligned}
%(x_1+x_2+x_3)^2 & = {2 \choose 2,0,0}x_1^2x_2^0x_3^0 + {2 \choose 0,2,0}x_1^0x_2^2x_3^0 + {2 \choose 0,0,2}x_1^0x_2^0x_3^2
%\\& + {2 \choose 1,1,0}x_1^1x_2^1x_3^0 + {2 \choose 0,1,1}x_1^0x_2^1x_3^1 + {2 \choose 9,1,1}x_1^0x_2^1x_3^1
%\\&= x_1^2+x_2^2 +x_3^2 + 2x_1x_2 + 2x_1x_3 + 2x_2x_3.
%\end{aligned}$$
On the other hand, for an $(s+1)$-tuple $(v_1,\dots, v_{s+1})$ in $P_{s+1}(u)$ with (at) least one zero coordinate, it will degenerate to an $s$-tuple in $P_s(u)$ after one zero coordinate is removed.
Hence, for $s\leq u$, we can partition the set $P_{s}(u)$ as
\[
P_{s}(u) = P^*_{s}(u) \sqcup P^*_{s-1}(u) \sqcup \cdots \sqcup P^*_1(u),
\] where $P^*_{r}(u)$ contains those $r$-tuples $(u_1,\dots, u_{r})$ with $u_1,\dots, u_{r} \geq 1$.

Now we consider the expansion of the sum $\sum_{k \preceq n } v_k k^u = 0$ with $n=2^{i_1}+\cdots + 2^{i_t}$ and $u>0$. By denoting $x_j=2^{i_j}$ and re-arranging the terms in its expansions, we obtain
\begin{equation}\label{key}
\begin{aligned}
\sum_{k \preceq n } v_kk^u & = \sum_{s=1}^t \sum_{\substack{supp(k) = \{i_{j_1},\dots, i_{j_s}\} \\ \{j_1,\dots, j_s\} \subseteq [t] \\ }} v_k (x_{j_1}+\dots + x_{j_s})^u
\\&= \sum_{s=1}^t \sum_{\substack{supp(k) = \{i_{j_1},\dots, i_{j_s}\} \\ \{j_1,\dots, j_s\} \subseteq [t] \\ }}  v_k \sum\limits_{(u_1,\dots, u_s) \in P_s(u)} \frac{u!}{u_{j_1}!\cdots u_{j_s}!} x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}}
\\& =  \sum_{s=1}^t\sum\limits_{\substack{supp(k) = \{i_{j_1},\dots, i_{j_s}\}  \\ \{j_1,\dots, j_s\} \subseteq [t] \\ (u_{j_1},\dots, u_{j_s})\in P_s(u)}} \frac{u!}{u_{j_1}!\cdots u_{j_s}!} v_k   x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}}
\\& =  \sum_{s=1}^t\sum\limits_{\substack{\{j_1,\dots, j_s\} \subseteq [t] \\ (u_{j_1},\dots, u_{j_s})\in P^*_s(u)}} \frac{u!}{u_{j_1}!\cdots u_{j_s}!} \left(  \sum_{\substack{\{i_{j_1},\dots, i_{j_s}\} \subseteq supp(k)   \\ k\preceq n }}  v_k \right)  x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}},
\end{aligned}
\end{equation} where the last equality is obtained by re-arranging the summands for $s=1,\dots, t$ according to the partition $P_{s}(u) = P^*_{s}(u) \sqcup P^*_{s-1}(u) \sqcup \cdots \sqcup P^*_1(u)$. \hfill$\square$

\begin{example} \label{Ex1}
	Assume $supp(n)=\{i_1,i_2,i_3\}$ with $t= 3$ and $u=2$,
	we have
	\begin{equation*}
	\begin{aligned}
	\sum_{k \preceq n } v_kk^2 &= \sum_{s=1}^t\sum\limits_{\substack{\{j_1,\dots, j_s\} \subseteq [t] \\ (u_{j_1},\dots, u_{j_s})\in P^*_s(u)}} {u \choose u_{j_1},\dots, u_{j_s}} \left(  \sum_{\substack{\{i_{j_1},\dots, i_{j_s}\} \subseteq supp(k)   \\ k\preceq n }}  v_k \right)  x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}}
	\\&=\sum\limits_{\substack{j\in [3] \\ u_j=2}} {2 \choose u_j}  \left(  \sum_{\substack{ \{i_j\} \subseteq supp(k)\\ k\preceq n}}  v_k \right) x_{j}^2 + \sum\limits_{\substack{{j_1,j_2}\in [3] \\ u_{j_1}=u_{j_2}=1}} {2 \choose u_{j_1},u_{j_2}}  \left(  \sum_{\substack{ \{i_{j_1},i_{j_2}\} \subseteq supp(k)\\ k\preceq n}}   v_k \right) x_{j_1}x_{j_2}
	\\& = \sum_{j=1}^3 \left(  \sum_{2^{i_j}\preceq k\preceq n}  v_k \right) x_{j}^2  +  2\sum\limits_{{j_1,j_2}\in [3]}  \left(  \sum_{ 2^{i_{j_1}}+2^{i_{j_2}} \subseteq k\preceq n}   v_k \right) x_{j_1}x_{j_2},
	\end{aligned}
	\end{equation*}
	where  the second equality has only two summations due to the fact that $P^*_{t}(u) = \emptyset$ when $t>u$. Denoting $v_k$ for $k = k_12^{i_1}+k_22^{i_2}+k_32^{i_3}$ as $v_{k_1k_2k_3}$,
	we obtain the following expansion
	\begin{align*}
		\sum_{k \preceq n } v_kk^2
		&= (v_{100}+v_{110}+v_{101}+v_{111}) x_1^2  + (v_{010}+v_{110}+v_{011}+v_{111}) x_2^2  + (v_{001}+v_{101}+v_{011}+v_{111}) x_3^2
		\\ & + 2 \left((v_{110}+v_{111}) x_1x_2 + (v_{101}+v_{111})x_1x_3 + (v_{011}+v_{111})x_2x_3 \right)
	\end{align*}
	where $x_1 = 2^{i_1}, x_2 = 2^{i_2}, x_3 = 2^{i_3} $.
\end{example}














%\section{Acknowledgments}
%The author was funded by the European Research Council (\textsf{ERC}) under the Advanced Grant program (reference number: 787390).
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\ifnum\full=0
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{alpha}
\bibliography{add}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\else
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{alpha}
\bibliography{add}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fi

\appendix
\mgnote{I propose this proof for the (very) loose upper bound on $t$-correctness.}
\section{A loose upper bound.}
\input{proof_loose_ubound.tex}

\mgnote{I add our work with Chunlei here. The proof covers only half of the statement for now: From left to a middle statement.\\ I believe the same middle statement can be reached from the right hand side of the equivalence to complete the proof.}
\section{Equivalence to the conjecture.}

\input{conjecture_equivalence.tex}

\end{document}
