
\def\anon{1} %% set to 1 for anonymous submissions, hides acknowledgements and author names
\def\full{1} %% set to 0 for springer proceedings


\ifnum\full=1
\documentclass[11pt]{llncs}


\addtolength{\parskip}{1pt}
\else
\documentclass[10pt, runningheads]{llncs}
\usepackage{times}
\fi


\input{header.tex}


\begin{document}


%\title{Notes: On the Resilience Order of Weightwise Almost Perfectly Balanced Functions}
\title{Notes: On the Resilience Order of W(A)PB Functions}


%\subtitle{}



	\titlerunning{On the Resilience Order of W(A)PB Functions}
	\author{
		\mbox{Pierrick M\'eaux\orcidID{0000-0001-5733-4341}}
	}

	\authorrunning{ P. M\'eaux}

	\institute{
University of Luxembourg, Luxembourg\\	\email{pierrick.meaux@uni.lu}
}






	%----------------------------------------------------------------
	\maketitle



 \setcounter{page}{1}

\begin{abstract}



%\keywords{Boolean functions, algebraic immunity, symmetric functions, HWBF}
\end{abstract}

\section{Introduction.}

\pmnote{draft}

\pmnote{Add the paper on S0 equivalence, the order based function, the articles from Deepak and Krishna, the 2 recent articles on WAPB constructions. 
}

\pmnote{correct reference eprint:IsiAldSeh25}



With the design of FLIP~\cite{EC:MJSC16}, established cryptographic criteria for Boolean functions—traditionally used to assess the security of filtered Linear Feedback Shift Registers (LFSRs), combined LFSRs, or more general stream ciphers—no longer directly apply. 
In this cipher, the relevant properties of the filtering Boolean function are not defined on the entire $\F_2^n$ but instead on a specific, publicly known subset of inputs. 
This shift has triggered a generalization of standard attacks and the development of new criteria for Boolean functions restricted to subsets or partitions of $\F_2^n$, beginning with the study of restricted cryptographic criteria~\cite{TOSC:CarMeaRot17}. 
So far these criteria have been regarded for general subsets~\cite{TOSC:CarMeaRot17,CANS:BonMea25}, subsets of fixed Hamming weight \eg \cite{IC:MMMRS18,Mesnager2018,DAM:GinMea22}, and affine spaces~\cite{DCC:CarFeuSal25}.


In FLIP, the input to the filtering function always has a fixed and known Hamming weight, and tailoring attacks to this constraint strengthens them considerably. 
This phenomenon reflects a broader trend: additional information about a cipher’s internal values may dramatically simplify attacks, as observed in algebraic side-channel cryptanalysis~\cite{INS:RenSta09} or lattice reduction with side information~\cite{C:DDGR20}. 
From the FLIP analysis emerged a systematic study of the partition of $\F_2^n$ into $n+1$ slices, the sets of all vectors of a given Hamming weight $\Ekn{k}{n}=\{x \in \F_2^n \mid \w(x)=k\}$ for $k\in[0,n]$. 
Notably, Hamming weight is also a widely used leakage model in side-channel attacks~\cite{book:JoyOli05,book:Standaert10,TCHES:DMMS20}, even though in practice approximate weight leakages are often considered more realistic~\cite{CHES:ORSW12,AC:BFG14,C:HMMRSU23}.

A fundamental security requirement for Boolean functions used in stream ciphers is balancedness: the output must take each value equally often to avoid exploitable statistical biases. 
In the context of slices, \cite{TOSC:CarMeaRot17} introduced functions that are balanced on every slice, called Weightwise (Almost) Perfectly Balanced (WAPB) functions. 
The qualifier “almost” accounts for the case where $n$ is not a power of two, so other slices than the ones of index $0$ and $n$ have odd cardinality and perfect balancedness is impossible. 
Since 2017, many works have introduced new constructions of WPB or WAPB functions, studying their global parameters—algebraic degree, Algebraic Immunity (AI), nonlinearity—as well as restricted parameters such as weightwise nonlinearity and weightwise algebraic immunity.

A large variety of constructions has been proposed. 
Recursive families and secondary constructions were first presented in~\cite{TOSC:CarMeaRot17}. 
Constructions based on field representations yield $2$-rotation symmetric WPB functions with high weightwise nonlinearity~\cite{DCC:LiuMes19,CC:MSLZ22}, and recently $2-\pi$ symmetric WAPB functions for all $n$~\cite{eprint:DalMalMea24}. 
Functions obtained by comparing the weights of two halves of the input achieve optimal AI~\cite{CC:TangLiu19,BFA:MesSuLi21}. 
Other approaches modify near-WPB linear or quadratic functions to impose balancedness on all slices~\cite{CC:MesSu21}, an idea later generalized to obtain WAPB functions from low-degree functions~\cite{DAM:LiSu20,DAM:GuoSu22,AMC:ZhangSu23,Mat:ZJZQ23,DAM:ZLCQZ23}. 
Secondary constructions have also been explored, such as direct sums~\cite{DAM:ZhuSu22}, Siegenthaler-type constructions combined with symmetric functions~\cite{INDO:GinMea22} and $t$-concatenation~\cite{eprint:IsiAldSeh25}. 
Moreover, several works have modified the support of non-WPB functions to analyze the distribution of cryptographic parameters—weightwise nonlinearity~\cite{DAM:GinMea22}, global nonlinearity~\cite{C2SI:GinMea23}, or algebraic immunity~\cite{Latin:GinMea23}. 
Heuristic search approaches, notably evolutionary algorithms, have been applied as well~\cite{CEC:MPJDL22,ASIACCS:YCL+23,ACI:ManKuLar22}. 
Additional constructions or studies of restricted criteria appear in~\cite{CC:MesZhoDin19,BFA:DalMal23,eprint:GinMea23,AMC:DalMal23}.


Despite this growing body of work, one central cryptographic parameter has remained largely unexplored for WAPB functions: resilience. 
Previous studies have characterized their nonlinearity, restricted nonlinearity, algebraic immunity (both global and weightwise), yet no general result on the resilience of WAPB functions had been established. 
This is particularly intriguing since WAPB functions are globally balanced by definition. 
One might expect them to behave, with respect to correlation immunity, similarly to random balanced functions on slices. 
However, our results show that this is not the case. 
Even the simplest case—WPB functions—provides a stark example: although they are balanced on every slice, they are never $1$-resilient. 
More generally, for all WAPB functions we obtain strong upper bounds on the resilience order, well below what one would predict from a random-function heuristic.

To analyse the resilience of WAPB functions, we adopt a perspective that is uncommon in Boolean function cryptanalysis: we study their behaviour as correctors on slices. 
A $t$-corrector is a function whose restricted Walsh coefficients vanish on all subsets of variables of size at most $t$. 
We show that the correction order of a Boolean function on slices is tightly connected to a system of linear equations involving restricted Walsh transforms of the function. 
For WAPB functions, the structure of these equations becomes remarkably rigid due to their slice-balancedness. 
This link provides a general framework to study resilience through corrector properties, and is of independent interest for understanding the number and structure of $t$-corrector or $t$-resilient Boolean functions.

A key component of our analysis is an unexpected algebraic connection between Krawtchouk matrices and Vandermonde matrices. 
By analysing the restricted Walsh equations satisfied by WAPB functions, we show that determining the maximum correction (and hence resilience) order of such functions reduces to a problem closely related to the classical Prouhet--Tarry--Escott problem. 
This connection allows us to derive tight bounds on the correction order of WAPB functions.

Our main result is that for infinitely many values of $n$, no WAPB function has correction order greater than the Hamming weight of $n$. 
We conjecture that this upper bound holds for all $n$. 
On the other hand, for every $n$ we construct WAPB functions with correction order exactly $\w(n)-1$, thus achieving an upper bound that is tight up to one unit. 
We verify experimentally that our conjecture holds for all $n\le 62$.



\subsection{Contributions.} 
In summary, this article provides: 
(i) the first general bounds on the resilience of WAPB functions, showing in particular that WPB functions are never $1$-resilient; 
(ii) a framework relating resilience to the correction order of Boolean functions on slices; 
(iii) a characterization of correction order in terms of restricted Walsh equations; 
(iv) a new algebraic link between Krawtchouk matrices and Vandermonde matrices; 
(v) the reduction of maximal correction order to a problem related to Prouhet--Tarry--Escott; 
(vi) tight asymptotic bounds and explicit constructions of WAPB functions reaching correction order $\w(n)-1$; 
(vii) experimental verification of our conjecture for all $n\le 62$. 
This study shows that, unlike other cryptographic parameters where WAPB functions mimic random behaviour, their resilience is subject to strict structural limitations imposed by slice-balancedness, revealing a new dimension of the algebraic theory of weightwise balanced Boolean functions.






\section{Preliminaries.}


We denote by $[1,n]$ the set of all integers from $1$ to $n$, \ie $\{1,\ldots,n\}$.
For readability, we use the notation $+$ instead of $\oplus$ for addition in $\F_2$.
For a vector $v \in \F_2^n$, we denote its Hamming weight by $\w(v)$, defined as $\w(v) = |\{ i \in [n] \mid v_i = 1 \}|$.
%For two vectors $v, w \in \F_2^n$, we denote their Hamming distance by $\hd(v,w)$, given by $\hd(v,w) = \w(v + w)$.
%Throughout this article, $\log$ denotes the base-2 logarithm.



%\subsection{Generalities on Boolean functions and cryptographic criteria}


%In this section, we review fundamental concepts of Boolean functions and define their key cryptographic properties.
%For a more in-depth discussion on Boolean functions and their cryptographic properties, we refer to the book~\cite{Carlet20}.


%\begin{definition}[Boolean Function]\label{def:bool_f}
%	A Boolean function $f$ in $n$ variables (an $n$-variable Boolean function) is a function from $\F_2^n$ to $\F_2$.
%	The set of all Boolean functions in $n$ variables is denoted by $\BN$.
%\end{definition}



%\begin{definition}[Algebraic Normal Form (ANF) and degree]\label{def:anf}
%	We call Algebraic Normal Form of a Boolean function $f$ its $n$-variable polynomial representation over $\F_2$ (\ie belonging to $\F_2[x_1,\dots,x_n]/(x_1^2+x_1,\dots,x_n^2+x_n)$):
%	\begin{align*}
%	f(x)= \sum_{I \subseteq [n]} a_I \left( \prod_{i \in I} x_i \right) =\sum_{I \subseteq [n]} a_I x^I,
%	\end{align*}
%	where $a_I\in \F_2$.
%	\begin{itemize}
%		\item The algebraic degree of $f$ is: $\degg(f)= \max_{\{I \; | \; a_I=1\}}|I|$ (with the convention that $\degg(0)=0$).
%		\item Any term $\prod_{i\in I}x_i$ in such an ANF is called a monomial and its degree equals $|I|$.
%	\end{itemize}
%\end{definition}


%\subsection{Cryptographic criteria of Boolean functions}


%In this article we study the algebraic immunity of various functions. In the following we give its definition, the algebraic immunity is entre autres used as the main parameter to estimate the complexity of the algebraic attack~\cite{EC:CouMei03} for filtered linear shift back register. Then we recall the concept of balancedness and nonlinearity that are the other main cryptographic criteria to consider for a Boolean function used in a stream cipher.



%\begin{definition}[Algebraic Immunity, ~\cite{EC:MeiPasCar04}] \label{def:ai}
%	The algebraic immunity of a Boolean function $f\in \BN$, denoted as $\AI(f)$, is defined as:
%	\[ \AI(f) = \min_{g \neq 0}\{ \degg(g) \; | \; fg = 0 \; \text{or} \; (f + 1)g = 0 \}{,} \]
%	where $\degg(g)$ is the algebraic degree of $g$.
%	The function $g$ is called an annihilator of $f$ (or $f + 1$).
	%	Additionally we denote $\AN(f) = \min_{g \neq 0}\{ \degg(g) \; | \; fg = 0\}$.
%\end{definition}



%\begin{definition}[Balancedness]\label{def:balancedness}
%	A Boolean function $f\in \BN$
%	is said to be balanced if and only if $|\supp(f)|=|\supp(f+1)|=2^{n-1}$,
%	where the support of $f$ denotes the set $\{x \in \F_2^n, \text{ such that } f(x)=1\}$.
%\end{definition}

%\begin{definition}[Nonlinearity] \label{def:nl}
%	The nonlinearity $\NL (f)$ of a Boolean function $f\in \BN$, where $n$ is a positive integer, is the minimum Hamming distance between $f$ and all the affine functions in $\BN$:
%	\[ \NL(f) = \min_{g,\, \degg(g)\leq 1} \{ d_H(f,g) \}{,} \]
%	with $d_H(f,g) = \#\{ x \in \F_2^n \;|\; f(x) \neq g(x) \}$ the Hamming distance between $f$ and $g$, and $g(x)=a\cdot x+\varepsilon$; $a\in \F_2^n, \varepsilon\in \F_2$ (where $\cdot$ is an inner product in $\F_2^n$).
%\end{definition}



\subsection{Boolean functions and cryptographic properties}

\begin{definition}[Balancedness]\label{def:balancedness}
	A Boolean function $f\in \Bn{n}$ is said to be balanced if $|\supp(f)|=2^{n-1}=|\supp(f+1)|$, where $\supp(f)$ denotes the support of $f$, the set $\{x\in \F_2^n \mid f(x)=1\}$.
\end{definition}


\begin{definition}[Walsh transform ]\label{def:walsh_transform}
	Let $f\in \Bn{n}$ be a Boolean function, its Walsh transform $\wt{f}$ at $a \in \F_2^n$ is defined as:
	\[  \wt{f} (a) = \sum_{x \in \F_2^n} (-1)^{f(x) +  a \cdot x },\]
	where $a \cdot x$ denotes the inner product.
\end{definition}

\begin{definition}[Resilience]\label{def:res}
	A Boolean function $f\in \Bn{n}$ is said to be $t$-resilient if for all $a\in \F_2^n$ such that $0\le \w(a)\le t$ we have $\wt{f}(a)=0$.
	We denote by $\res(f)$ the maximum $t$ such that $f$ is $t$-resilient but not $(t+1)$-resilient.
\end{definition}

\begin{definition}[Corrector]\label{def:corr}
	A Boolean function $f\in \Bn{n}$ is said to be a $t$-corrector if for all $0\le k \le t$ it satisfies:
	\[\sum_{a\in \F_2^n \atop{\w(a)=k}} \wt{f}(a)=0.\]
	We denote by $\corr(f)$ the maximum $t$ such that $f$ is a $t$-corrector but not $(t+1)$-corrector.
\end{definition}


\subsection{Slices, restricted Walsh transform, and WAPB functions}




\begin{definition}[Slices of the Boolean hypercube]\label{def:slices}
	For $k \in [0,n]$, we define the $k$-th slice of the $n$-dimensional Boolean hypercube as the set $\Ekn{k}{n} = \{x \in \F_2^n \mid \w(x) = k\}$.
\end{definition}

According to Definition~\ref{def:slices}, the Boolean hypercube is partitioned into $n+1$ slices, where each slice consists of vectors sharing the same Hamming weight.
We refer to properties that hold slice-wise as weightwise properties.
The $n$-variable symmetric Boolean functions are precisely those that are constant on each slice.



\begin{definition}[Restricted Walsh transform]\label{def:restWalsh}
	Let $f\in \Bn{n}$, $S \subset \F_2^n$, its Walsh transform restricted to $S$ at $a \in \F_2^n$ is defined as:
	\[  \wt{f,S} (a) = \sum_{x\in S} (-1)^{f(x)+ax}.\]
	For $S=\Ekn{k}{n}$ we denote $\wt{f,\Ekn{k}{n}} (a)$ by $\wtk{f}{k}(a)$, and for $a= 0_{n}$ we denote $\wtk{f}{k}(a)$ as $\wtk{f}{k}$.

\end{definition}


\begin{definition}[Weightwise (Almost) Perfectly Balanced Function (WPB and WAPB)\cite{TOSC:CarMeaRot17}]\label{def:WPB}
	Let $m\in \N^*$ and $f$ be a Boolean function in $n=2^m$ variables. It will be called weightwise perfectly balanced (WPB) if, for every $k\in[1,n-1]$, $f$ is balanced on the slice $k$, that is $\forall k \in [1,n-1], |\suppk{k}(f)|=\binom{n}{k}/2$, and:
	\[f(0,\cdots,0)=0,\quad \text{ and } \quad f(1,\cdots,1)=1.\]
	The set of WPB functions in $2^m$ variables is denoted by $\WPB{m}$.

	%	When $n$ is not a power of $2$, some other weights than $k=0$ and $n$ give slices of odd cardinality, in this case we call $f\in \Bn{n}$ weightwise almost perfectly balanced (WAPB) if:
	When $n$ is not a power of $2$, some other weights than $k=0$ and $n$ give slices of odd cardinality. We consider the generalization for any $n\in \N^*$, in this case we call $f\in \Bn{n}$ weightwise almost perfectly balanced (WAPB) if:
	\[|\suppk{k}(f)|= \left \{
	\begin{array}{l l}
	|\Ekn{k}{n}|/2  & \text{ if } |\Ekn{k}{n}| \text{ is even, } \\
	(|\Ekn{k}{n}|\pm 1)/2  & \text{ if }  |\Ekn{k}{n}| \text{ is odd.}
	\end{array}\right.\]
	The set of WAPB functions in $n$ variables is denoted $\WAPB{n}$.

\end{definition}




\begin{Prop}[WAPB functions and restricted Walsh transform]\label{prop:WAPBWalsh}

	Let $n\in \N^*$, $f\in \Bn{n}$ is WAPB if and only if:
	\[\forall k \in [0,n], \, \wtk{f}{k}(0_n)=
	\left \{
	\begin{array}{l l}
	0  & \text{ if } |\Ekn{k}{n}| \text{ is even, } \\
	\pm 1 & \text{ if }  |\Ekn{k}{n}| \text{ is odd.}
	\end{array}\right. \]
	If $n=2^m$ with $m\in \N^*$, $f\in \Bn{n}$ is WPB if and only if:
	\[\wtk{f}{0}=1, \quad \wtk{f}{n}=-1, \text{ and } \quad \forall k \in [1,n-1] \,  \wtk{f}{k}=0. \]

\end{Prop}

Below we recall Lucas's Theorem.

\begin{lemma}For a prime \( p \) and non-negative integers $n, k $ with $n \geq k $, the following congruence relation holds:
	\[
	\binom{n}{k} \equiv \prod_{i=0}^{r} \binom{n_i}{k_i} \pmod{p},
	\]
	where
	$
	n = n_r p^r + \cdots + n_1 p + n_0
	$ and
	$
	k = k_r p^r + \cdots + k_1 p + k_0
	$
	are the \( p \)-ary expansions of \( n\) and \( k \), respectively.
\end{lemma}

%\subsubsection{Krawtchouk polynomials.}
We use Krawtchouk polynomials to characterize the correction order of WAPB functions.
We give the necessary preliminaries here and refer to \eg ~\cite{book:MacSlo78} for more details.

\begin{definition}[Krawtchouk Polynomials]\label{def:Kraw}
	The Krawtchouk polynomial of degree $k$, with $0\leq k\leq n$ is given by: $$ \displaystyle \kraw{k}{\ell}{n}=\sum_{j=0}^{k} (-1)^j \binom{\ell}{j} \binom{n-\ell}{k-j},$$
	where we take the binomial coefficient ${m\choose r} = 0$ when $m<r$ and $r<0$ by convention.
\end{definition}
Krawtchouk polynomials can be characterized by the generating series: $$ \displaystyle (1+z)^{n-\ell} (1-z)^\ell=\sum_{k=0}^\infty \kraw{k}{\ell}{n} z^k.$$ In addition,
there is an interesting connection between Krawtchouk polynomials and linear functions restricted on the slice $\Ekn{k}{n}$:
\begin{equation}\label{Eq_K_rwt}
\kraw{k}{\ell}{n} = \sum_{u\in \Ekn{k}{n}}(-1)^{ u \cdot v}, \quad \forall v\in \Ekn{\ell}{n}.
\end{equation}
%$\kraw{k}{\ell}{n}$ is the value of the restricted Walsh transform on $\Ekn{k}{n}$ of any $n$ variable linear function $a\cdot \ell$ such that $\w(a)=\ell$,








\begin{Prop}[Krawtchouk polynomials relation]\label{prop:Kr}
	Let $n\in \N^*$ and $k\in [0,n]$. The following relations hold:
\begin{itemize}
	\item $\kraw{k}{n-\ell}{n}=(-1)^k \kraw{k}{\ell}{n}$,
	\item $\kraw{n-k}{x}{n}=(-1)^x \kraw{k}{x}{n}$,
		\item if $n$ is even and $k$ is odd, $\kraw{k}{n/2}{n}=0$,
	\item if $n$ is even, $\kraw{n/2}{1}{n}=0$.
	\item $\binom{n}{\ell}\kraw{k}{\ell}{n}=\binom{n}{k}\kraw{\ell}{k}{n}$.
	\end{itemize}
\end{Prop}



\begin{Prop}[{~\cite[Prop.4]{DCC:DalMaiSar06}}]\label{prop:KrDMS}
Let $n\in \N^*$ and $k\in [0,n]$, the following hold:
\[(k+1)\kraw{k+1}{\ell}{n}=(n-2\ell)\kraw{k}{\ell}{n}-(n-k+1)\kraw{k-1}{\ell}{n}.\]
\end{Prop}

%\pmnote{add Lucas' theorem}


\section{Characterizations of $t$-correctors}\label{sec:corr}



We rewrite the $t$-corrector property using the notation of restricted Walsh transform.


\begin{theorem}\label{thm:WalsCorr}
	Let $n\in \N^*$ and $t\in \N$ such that $t\le n$. A Boolean function $f\in \Bn{n}$ has $\corr(f) = t$ if and only if $t$ is the maximum integer such that the restricted Walsh transform satisfies
	\begin{equation}\label{Eq_RWT}
	\sum_{\ell=0}^{n} \wtk{f}{\ell} \, \kraw{k}{\ell}{n}=0 \quad \text{ for } k=0,1,\dots, t.
	\end{equation}


	%\begin{proposition}\label{thm:WalsCorr}
	%	Let $n\in \N^*$ and $t\in \N$ such that $t\le n$. A Boolean function $f\in \Bn{n}$ is a $t$-corrector if the following holds on its restricted Walsh transform:
	%	\begin{itemize}
	%		\item If $n$ is odd: for $0\le k \le t$,
	%		\[\sum_{a\in \Ekn{k}{n}} \wt{f}(a)=\sum_{\ell=0}^{(n-1)/2} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell})=0.\]
	%	\item If $n$ is even: for $0\le k \le t$,
	%		\[\sum_{a\in \Ekn{k}{n}} \wt{f}(a)=\wtk{f}{n/2} \, \kraw{k}{n/2}{n}+ \sum_{\ell=0}^{n/2-1} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell})=0.\]
	%	\end{itemize}
\end{theorem}
\begin{proof}

	%We denote by $A_k$ the quantity $A_k=\sum_{a\in \F_2^n \atop{\w(a)=k}} \wt{f}(a)$.
	%From Definition~\ref{def:corr}, $f$ is a $t$-corrector if $A_k=0$ for $k\in [0,t]$.
	%\[A_k=\sum_{a\in \F_2^n \atop{\w(a)=k}} \wt{f}(a).\]
	Note that
	\begin{align*}
	\sum_{a\in \Ekn{k}{n}} \wt{f}(a)&=\sum_{a\in \Ekn{k}{n}} \sum_{x\in \F_2^n} (-1)^{f(x)+a \cdot x}\\
	&= \sum_{x\in \F_2^n} (-1)^{f(x)}  \left(\sum_{a\in \Ekn{k}{n}}(-1)^{a \cdot x}\right)\\
	&=\sum_{\ell=0}^{n} \sum_{x\in \Ekn{\ell}{n}} (-1)^{f(x)}  \left(\sum_{a\in \Ekn{k}{n}}(-1)^{a \cdot x}\right)\\
	&=\sum_{\ell=0}^{n} \sum_{x\in \Ekn{\ell}{n}} (-1)^{f(x)} \,  \kraw{k}{\ell}{n}\\
	&=\sum_{\ell=0}^{n} \wtk{f}{\ell} \, \kraw{k}{\ell}{n},
	\end{align*}
	where the last second equality follows from~\eqref{Eq_K_rwt}.
	The desired statement is then proved by Definition~\ref{def:corr}.
\end{proof}

%Using Property~\ref{prop:Kr}, when $n$ is odd we obtain:
%\[A_k=\sum_{\ell=0}^{(n-1)/2} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell}). \]
%When $n$ is even we obtain:
%\[A_k=\wtk{f}{n/2} \, \kraw{k}{n/2}{n}+ \sum_{\ell=0}^{n/2-1} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell}). \]
%It allows to conclude.



%\begin{corollary}
%
%\end{corollary}

Following from Proposition~\ref{prop:WAPBWalsh}, we reformulate WAPB functions of correction order $t$ in terms of Krawtchouk polynomials.

\begin{definition}\label{def:restWalshVect}
	Let $n\in \N^*$ and $f\in \BN$, we define its restricted Walsh vector, denoted by $\rwv{f}$, in $\Z^{n+1}$ as:
	\[\rwv{f}=(\wtk{f}{0},\wtk{f}{1},\cdots,\wtk{f}{n-1},\wtk{f}{n})^\intercal\]

\end{definition}


\begin{definition}\label{def:KrMat}
	Let $n\in \N^*$ and $t\in \N$ such that $t\le n$, we define the Krawtchouk matrix $\matK$ of order $(n+1)$ as:
	\[\forall k \in [0,n], \ell \in [0,n], \quad \matK_{k,\ell}=\kraw{k}{\ell}{n}.\]

	%	$\KrM{n}{k}\in 	\Z^{(n+1)\times (k+1)}$ as:

\end{definition}

Denote by $\matK^{(t+1)}$ the submatrix formed by the leading $(t+1)$ rows of $\matK$.
By Theorem~\ref{thm:WalsCorr} we see that $f$ is a $t$-corrector if and only if:
\begin{equation}\label{Eq_t-corrector}
\matK^{(t+1)}\cdot \rwv{f}=\textbf{0}_{t+1}^\intercal.
\end{equation}
The following theorem provides an interesting connection between the Krawtchouk matrix and the Vandemonde matrix. This connection facilitates the study of the above equation.

\begin{theorem}\label{Th_K_V_matrices}
	Let $\matK$ be the Krawtchouk matrix with $\matK_{k,\ell} = \kraw{k}{\ell}{n}$ and $\matV$ be the Vandemonde matrix with $V_{k,\ell} =\ell^k$, where $k,\ell$ with $0\leq k,\ell\leq n$ index the rows and columns, respectively.
	Let
	\[
\alpha_k = -\frac{n-k}{2}, \beta_k = \frac{n}{2}, 	\gamma_k = -\frac{k}{2}, \quad 0\leq k\leq n,
	\]
	and for $1\leq r\leq n$ define $r\times(r+1)$ matrices $\matH_r$ as follows:
	\begin{equation}\label{Eq_H}
	%         H_1 = \begin{bmatrix}
	%     \beta_0 & \gamma_1
	% \end{bmatrix},
	% \quad
	% H_2 =  \begin{bmatrix}
	%            \beta_0 & \gamma_1 \\
	%            \alpha_0 & \beta_1 & \gamma_2
	%        \end{bmatrix},
	% \cdots,
	\matH_{r} = \begin{bmatrix}
	\beta_0 & \gamma_1 &  & & &\\
	\alpha_0 & \beta_1 & \gamma_2 & & &\\
	& \alpha_1 & \beta_2 & \gamma_3 &  &
	\\
	& & \ddots & \ddots & \ddots &\\
	& & & \alpha_{r-2} &\beta_{r-1} & \gamma_{r}
	\end{bmatrix}.
	\end{equation}
	Then we have \[
	\matM \cdot \matK = \matV,
	\]
	where $\matM$ is an $(n+1)\times(n+1)$ lower triangular matrix whose rows are given by the following recursion:
	\begin{equation}\label{Eq_Matrix_M}
	% \begin{array}{rcl}
	%     \matM_{0,0} &=& 1 \\
	%     \matM_{1,[0,1]} &=& \matM_{0,[0,0]}H_1 \\
	%     \matM_{2,[0,2]} &=& \matM_{1,[0,1]} H_2\\
	%     % & \vdots & \\
	%     % \matM_{r+1,[0,r+1]} &=& \matM_{r,[0,r]} H_r
	%     \\
	%     &\vdots & \\
	%     \matM_{n,[0,n]} & = & \matM_{n-1,[0,n-1]}H_n,
	% \end{array}
	\matM_{0,0} = 1,\quad \matM_{r,[0,r]} = \matM_{r-1,[0,r-1]} \matH_r \quad \text{for } r = 1, 2,\dots, n,
	\end{equation}
	where $\matM_{r,[0,r]} = [\matM_{r,0},\dots, \matM_{r,r}]$ denotes the leading $(r+1)$ entries in the $r$-th row of $M$; in other words,
  \[
  \matM_{r,[0,r]} = [1] \cdot \matH_1\cdot\matH_2 \cdots \matH_r, \quad r=2,\dots, n.
  \]

\end{theorem}
\begin{proof}
	The Property~\ref{prop:KrDMS} is crucial for us to derive the lower triangular matrix $\matM$ satisfying $\mathbf{M} \cdot \mathbf{K} = \mathbf{V}$.

	We will proceed by induction on $r$ to gradually determine the non-zero entries
	in each row of $\mathbf{M}$ denoted as the vector $\matLead{M}{r}{r+1}$.
	It is straightward that Property~\ref{prop:KrDMS} is equivalent to
	\begin{equation*}
	\ell\cdot\kraw{k}{\ell}{n} = -\frac{n - (k - 1)}{2}\kraw{k-1}{\ell}{n} + \frac{n}{2}\kraw{k}{\ell}{n}  -\frac{k+1}{2}\kraw{k+1}{\ell}{n} ,
	\end{equation*}
	which can be rewritten as
	\begin{equation}\label{eq:prop3sym}
	\ell\cdot\kraw{k}{\ell}{n} = \alpha_{k-1}\kraw{k-1}{\ell}{n} + \beta_k\kraw{k}{\ell}{n} + \gamma_{k+1}\kraw{k+1}{\ell}{n}= \begin{bmatrix}
	\alpha_{k-1} & \beta_k & \gamma_{k+1}
	\end{bmatrix} \cdot \begin{bmatrix*}[l]
	\kraw{k-1}{\ell}{n} \\ \kraw{k}{\ell}{n} \\ \kraw{k+1}{\ell}{n}
	\end{bmatrix*},
	\end{equation}
	where  $\alpha_{k-1} = -\frac{n - (k - 1)}{2}$, $\beta_k = \frac{n}{2}$ and $\gamma_{k+1} = -\frac{k+1}{2}$ as defined in Theorem~\ref{Th_K_V_matrices}.

	\underline{Initialization:} Let $r = 0$. Since $\kraw{0}{\ell}{n} = 1$ for all $\ell, n$, it follows
	that $\matLead{M}{0}{n} = \begin{bmatrix}1 & 0 & \cdots & 0\end{bmatrix}$ and that $\matLead{M}{0}{n}\cdot \matK = \matLead{V}{0}{n}.$

	Let $r = 1$. We want to determine $\matLead{M}{1}{2}$ that yields $\ell^1$, which corresponds to Row 1 in $\mathbf{V}$.
	To do so, we expand $\ell^1$ using Eq.~\eqref{eq:prop3sym}.
	\begin{equation*}
	\begin{split}
	\ell^1 &= \ell \cdot \kraw{0}{\ell}{n}\\
	&= \beta_0 \kraw{0}{\ell}{n} + \gamma_1 \kraw{1}{\ell}{n} \\
	&= \eqX{\begin{bmatrix}1\end{bmatrix}}{\matLead{M}{0}{1}} \cdot \eqX{\begin{bmatrix}\beta_0 & \gamma_1\end{bmatrix}}{\mathbf{H}_1} \cdot \begin{bmatrix}\kraw{0}{\ell}{n}\\\kraw{1}{\ell}{n}\end{bmatrix}
	\end{split}
	\end{equation*}
	As such, $\matLead{M}{1}{2} = \begin{bmatrix}\beta_0 & \gamma_1\end{bmatrix}$ and $\matLead{M}{1}{n}\cdot \matK = \matLead{V}{1}{n}.$

	Let $r = 2$. We want to determine $\matLead{M}{2}{3}$ that yields $\ell^2$ in $\mathbf{V}$.
	Similarly, we expand $\ell^2$ using Eq.~\eqref{eq:prop3sym}.
	\begin{equation*}
	\begin{split}
	\ell^2 = \ell \cdot \ell &= \ell \Big(\gamma_1 \kraw{1}{\ell}{n} + \beta_0 \kraw{0}{\ell}{n}\Big)\\
	& = \beta_0 \ell  \kraw{0}{\ell}{n} + \gamma_1 \ell \kraw{1}{\ell}{n} \\
	%            &= (\beta_0^2 + \gamma_1\alpha_0)\kraw{0}{\ell}{n} + (\gamma_1\beta_0 + \gamma_1\beta_1)\kraw{1}{\ell}{n} + (\gamma_1\gamma_2)\kraw{2}{\ell}{n}\\
	%            &= \begin{bmatrix}(\beta_0^2 + \gamma_1\alpha_0) & (\gamma_1\beta_0 + \gamma_1\beta_1) & (\gamma_1\gamma_2)\end{bmatrix} \cdot \begin{bmatrix}\kraw{0}{\ell}{n}\\\kraw{1}{\ell}{n}\\\kraw{2}{\ell}{n}\end{bmatrix}\\
	& = \beta_0  \begin{bmatrix}\beta_0 & \gamma_1\end{bmatrix} \cdot \begin{bmatrix}\kraw{0}{\ell}{n}\\\kraw{1}{\ell}{n}\end{bmatrix} + \gamma_1 \begin{bmatrix}\alpha_0 & \beta_1 & \gamma_2 \end{bmatrix} \cdot \begin{bmatrix}\kraw{0}{\ell}{n}\\\kraw{1}{\ell}{n}\\\kraw{2}{\ell}{n}\end{bmatrix}  \\
	&= \eqX{\begin{bmatrix}\beta_0 & \gamma_1\end{bmatrix}}{\matLead{M}{1}{2}} \cdot \eqX{\begin{bmatrix}\beta_0 & \gamma_1 & 0\\\alpha_0 & \beta_1 & \gamma_2\end{bmatrix}}{\mathbf{H}_2}\cdot \begin{bmatrix}\kraw{0}{\ell}{n}\\\kraw{1}{\ell}{n}\\\kraw{2}{\ell}{n}\end{bmatrix}
	\end{split}
	\end{equation*}
	As such, $\matLead{M}{2}{3} = \matLead{M}{1}{2}\cdot \matH_2 =\begin{bmatrix}(\beta_0^2 + \gamma_1\alpha_0) & (\gamma_1\beta_0 + \gamma_1\beta_1) & (\gamma_1\gamma_2)\end{bmatrix}$.
	Thus,
	we have
	\[
	\matLead{M}{2}{n}\cdot \matK = \matLead{M}{2}{3} \begin{bmatrix}\kraw{0}{\ell}{n}\\\kraw{1}{\ell}{n}\\\kraw{2}{\ell}{n}\end{bmatrix} = \matLead{V}{2}{n}.
	\]


	\bigskip

	\underline{Induction:} we shall prove that if the statement is true for $r-1$, then it is true for $r$.

	Again, we use Eq.~\eqref{eq:prop3sym} to expand $\ell^{r}$ as follows:
	\begin{equation*}
	\begin{split}
	\ell^{r} = \ell \cdot \ell^{r-1} &= \ell \Big( \sum_{k=0}^{r-1}\mathbf{M}_{r-1,i} \cdot \kraw{k}{\ell}{n}\Big)
	%        \\&=  \sum_{i=0}^{r-1}\mathbf{M}_{r-1,i} \ell \kraw{k}{\ell}{n}
	\\& = \begin{bmatrix}\mathbf{M}_{r-1,0} & \mathbf{M}_{r-1,1} & \ldots & \mathbf{M}_{r-1,r-1}\end{bmatrix} \cdot \begin{bmatrix}\ell \kraw{0}{\ell}{n}\\ \ell  \kraw{1}{\ell}{n}\\\vdots\\ \ell \kraw{r-1}{\ell}{n}\end{bmatrix}
	%        \\&= \sum_{k=0}^{r-1} \Big( \mathbf{M}_{r-1,k} \cdot \big[ \alpha_{k-1}\kraw{k-1}{\ell}{n} + \beta_k\kraw{i}{\ell}{n} + \gamma_{k+1}\kraw{k+1}{\ell}{n} \big] \Big)
	\\  &= \begin{bmatrix}\mathbf{M}_{r-1,0} & \mathbf{M}_{r-1,1} & \ldots & \mathbf{M}_{r-1,r-1}\end{bmatrix} \cdot \begin{bmatrix}\beta_0 & \gamma_1\\\alpha_0 & \beta_1 & \gamma_2 & & \\ & \ddots & \ddots & \ddots\\ & & \alpha_{r-2} & \beta_{r-1} & \gamma_{r}\end{bmatrix} \cdot \begin{bmatrix}\kraw{0}{\ell}{n}\\\kraw{1}{\ell}{n}\\\vdots\\\kraw{r}{\ell}{n}\end{bmatrix}
	\\&= \matM_{r-1,[0,r]}\cdot \matH_r \cdot \begin{bmatrix}\kraw{0}{\ell}{n}\\\kraw{1}{\ell}{n}\\\vdots\\\kraw{r}{\ell}{n}\end{bmatrix}
	\end{split}
	\end{equation*} which implies $\matM_{r,[0,r]} = \matM_{r-1,[0,r]}\cdot \matH_r$ and $\matLead{M}{r}{n} \cdot \matK = \matLead{V}{r}{n}$. The desired statement follows.
\end{proof}

Denote by $\matM_{[0,t],[0,t]}$ the $(t+1)$-order submatrix formed by the leading $(t+1)$ rows and columns of $\matM$.
It is clear that $\matM_{[0,t],[0,t]}$ is invertible since the matrix $\matM$ is an invertible lower triangular matrix by Theorem~\ref{Th_K_V_matrices}.
Then it follows from $\matM \cdot \matK = \matV$ that
\[
\matM_{[0,t],[0,t]} \cdot \matK^{(t+1)} = \matV^{(t+1)},
\]where $\matV^{(t+1)}$ is the submatrix formed by the leading $(t+1)$ rows of $\matV$.
Therefore,  Theorem~\ref{thm:WalsCorr} can be reformulated as follows.

\begin{theorem}\label{thm:t_corrector_Vandemonde_matrix}
	Let $n\in \N^*$ and $t\in \N$ such that $t\le n$.
	A Boolean function $f\in \Bn{n}$ has $\corr(f) = t$ if and only if $t$ is the maximum integer such that the restricted Walsh transform vector $\rwv{f}$ satisfies
\begin{equation}\label{Eq_RWT}
 \begin{bmatrix}
1 & 1 & 1 & \cdots & 1 \\
0 & 1 & 2 & \cdots & n \\
&  &  \cdots &\cdots &  \\
0 & 1 & 2^{t} & \cdots & n^{t}
\end{bmatrix}\cdot
\begin{bmatrix}
\wtk{f}{0} \\ \wtk{f}{1} \\ \vdots \\ \wtk{f}{n}
\end{bmatrix} = \textbf{0}_{t+1}^\intercal.
\end{equation}




%\begin{proposition}\label{thm:WalsCorr}
%	Let $n\in \N^*$ and $t\in \N$ such that $t\le n$. A Boolean function $f\in \Bn{n}$ is a $t$-corrector if the following holds on its restricted Walsh transform:
%	\begin{itemize}
%		\item If $n$ is odd: for $0\le k \le t$,
%		\[\sum_{a\in \Ekn{k}{n}} \wt{f}(a)=\sum_{\ell=0}^{(n-1)/2} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell})=0.\]
%	\item If $n$ is even: for $0\le k \le t$,
%		\[\sum_{a\in \Ekn{k}{n}} \wt{f}(a)=\wtk{f}{n/2} \, \kraw{k}{n/2}{n}+ \sum_{\ell=0}^{n/2-1} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell})=0.\]
%	\end{itemize}




\end{theorem}

Furthermore, for a WAPB function $f$, we have $\rwv{f}\in \{-1,0,1\}^{n+1}$ from Property~\ref{prop:WAPBWalsh}. Moreover, since the number of nonzero values corresponds to the odd parity of the associate binary coefficient, we have $\w(\rwv{f})=2^{\w(n)}$, and the nonzero coefficients in $\rwv{f}$ are the $\ell$-th entries such that $\ell\preceq n$.
Therefore, we have the following result:

\begin{corollary}\label{Th-corrector-by-Vandemonde}
		Let $n\in \N^*$ and $t\in \N$ such that $t\le n$.
	Let $\matW$ denote the submatrix formed by the $\ell$-th column in $\matV^{(t+1)}$ with $\ell \preceq n$.
	Then for an $n$-variable WAPB function $f$ with $\corr(f)=t$, its restricted Walsh vector $\rwv{f}$
	is determined by the solutions $\mathbf{y}=(y_0,y_1,\dots, y_{2^t-1})^\intercal \in \{\pm 1\}^{2^t}$ of the following
	system of equations:
	\[
	\matW \cdot \mathbf{y} = \mathbf{0}_{{t+1}}^{\intercal}.
	\]
\end{corollary}

The characterization of $t$-corrector in terms of the Vandemonde matrix above will be used to study the existence of WPB functions and WAPB functions of certain order $t$ in the next section.

%\section{WPB functions and corrector order}
\section{Correction order of W(A)PB Functions}

Section \ref{sec:corr} characterizes $t$-corrector in terms of restricted Walsh transforms and Vandemonde matrices. This section will further discuss correction order of W(A)PB functions.
%Note that for any Boolean function $f$ and its complement $f \oplus 1$, their restricted Walsh vectors satisfy
%\[
%\rwv{f \oplus 1} = (\wtk{f\oplus 1}{0}, \dots, \wtk{f\oplus 1}{n})  =-(\wtk{f\oplus 1}{0}, \dots, \wtk{f\oplus 1}{n})= - \rwv{f}.
%\]
%Without loss of generality, we assume $f(0,\dots, 0)=1$ (equivalently, $\wtk{f}{0} = 1$) throughout what follows.



\subsection{Non-existence of $1$-resilient WPB functions}

Note that the slice $\Ekn{k}{n}$ has even cardinality if and only ${n\choose k}$ is even, equivalently, $k \not\preceq n$.
By definition, WPB functions are balanced on each $\Ekn{k}{n}$ for any $k\in [1,n-1]$, indicating that they exist only for the case where $n=2^m$ for certain positive integer $m$.
The following proposition shows the non-existence of $1$-resilient WPB functions.
\begin{proposition}\label{thm:WPB}
	Let $f$ be an $n$-variable WPB function with $n=2^m$ for $m\in \N^{*}$.
	Then  $\res(f) = \corr(f) = 0$.
\end{proposition}
\begin{proof}
	By Definition~\ref{def:WPB}, a WPB function is balanced, hence $0$-corrector and $0$-resilient.
	Below we show a WPB function cannot be $1$-corrector, thus not $1$-resilient.

	By Theorem~\ref{thm:t_corrector_Vandemonde_matrix} we see that $\corr(f) = 1$ if and only if
	\[
	\matV^{(2)}\cdot \rwv{f} = \mathbf{0}_2^{\intercal},
	\] where the restricted Walsh vector $\rwv{f}$ satisfies that $\wtk{f}{\ell} = 0$ for any $\ell \in [1,n-1]$ since $f$ is balanced on $\Ekn{\ell}{n}$.
	Excluding these columns in $\matV^{(2)}$ reduces the above system to
	\[
	\begin{bmatrix}
	1 & 1 \\ 0 & n
	\end{bmatrix}
	\cdot \begin{bmatrix}
	\wtk{f}{0} \\ \wtk{f}{n}
	\end{bmatrix} =
	\begin{bmatrix}
	0 \\ 0
	\end{bmatrix},
	\]
	which clearly contradicts the definition of WPB functions in Definition~\ref{def:WPB}.
	%	To show that $f$ is not $1$-corrector we show the values of its restricted Walsh transform do not satisfy the characterization of Proposition~\ref{thm:WalsCorr}.
	%
	%	Using Proposition~\ref{thm:WalsCorr} and Property~\ref{prop:Kr}, for $n=2^m$ we have:
	%	\[\sum_{a\in \Ekn{1}{n}} \wt{f}(a)=\wtk{f}{n/2} \, \kraw{1}{n/2}{n}+ \sum_{\ell=0}^{n/2-1} \kraw{1}{\ell}{n} \, ( \wtk{f}{\ell} - \wtk{f}{n-\ell}).\]
	%	Since $f$ is WPB, using Property~\ref{prop:WAPBWalsh} we obtain:
	%	\[\sum_{a\in \Ekn{1}{n}} \wt{f}(a)=0+2\kraw{1}{0}{n}=2n\ne 0,\]
	%	hence $f$ is not $1$-corrector by Proposition~\ref{thm:WalsCorr}. Since $f$ is not $1$-corrector it implies $f$ is not $1$-resilient.
\end{proof}

%We recall that the WAPB functions when $n=2^m$ are either of the form $f$ or $1+f$ with $f\in \WPB{m}$, hence all $2^m$-variable WAPB functions are $0$-resilient and not $1$-resilient.
%
%In the subsequent sections we shall discuss the cases where $n$ has higher Hamming weights.

%\subsection{WAPB functions of correction order $t\geq 2$}


\subsection{Correction order of $n$-variable WAPB functions when $\w(n)=2$ and $\w(n)=3$}

%We can extend the bound of the correction order to $\WAPB{n}$ when $\w(n)=2$, using the Krawtchouk polynomials of degree $2$.

%\begin{proposition} Let $n\in \N^*$ with $\w(n)=2$. Then there exists a WAPB function $f$ with $\corr(f)=1$, and the
%	restricted Walsh vector $\rwv{f}$ is uniquely given by
%	\[
%	\wtk{f}{\ell} = (-1)^{\w(\ell)}, \forall \, \ell \preceq n.
%	\]
%	Furthermore, there exists no WAPB function $f$ with $\corr(f)=2$.
%\end{proposition}

\begin{proposition}\label{prop:t=2} Let $n\in \N^*$ with $\w(n)=2$. Then any WAPB function $f$ has $\corr(f)\leq 1$.
	Furthermore, the equality is reached if and only if the restricted Walsh vector $\rwv{f}$ is given by
	\[
	\wtk{f}{\ell} =   \wtk{f}{0} \cdot (-1)^{\w(\ell)}, \forall \, \ell \preceq n.
	\]
%	Furthermore, there exists no WAPB function $f$ with $\corr(f)=2$.
\end{proposition}

\begin{proof}
	By Theorem~\ref{Th-corrector-by-Vandemonde} it suffices to consider the solution of the linear system $\matW \cdot \mathbf{y} = \mathbf{0}_{{t+1}}^{\intercal}$ for $t=1$ and $t=2$.
	More precisely, letting $n=2^{i_1} + 2^{i_2}$ with positive integers $i_1< i_2$, we need to study the following two linear systems:
	\begin{equation}\label{Eq_t=1}
	\begin{bmatrix}
	1 & 1 & 1 & 1 \\
	0 & 2^{i_1} & 2^{i_2} & (2^{i_1}+2^{i_2})
	\end{bmatrix}
	\mathbf{y} =  \begin{bmatrix}
	0 \\ 0
	\end{bmatrix},
	\end{equation}
	and
	\begin{equation}\label{Eq_t=2}
	\begin{bmatrix}
	1 & 1 & 1 & 1 \\
	0 & 2^{i_1} & 2^{i_2} & (2^{i_1}+2^{i_2}) \\
	0 & 2^{2i_1} & 2^{2i_2} & (2^{i_1}+2^{i_2})^2
	\end{bmatrix}
	\mathbf{y}  =  \begin{bmatrix}
	0 \\ 0 \\ 0
	\end{bmatrix},
	\end{equation} where $\mathbf{y} = (y_{00},y_{01},y_{10},y_{11})\in \{\pm 1\}^4$.
	It can be easily verified that the solutions of \eqref{Eq_t=1} are given by
	\[
	\mathbf{y} = \pm (1, -1,-1, 1).
	\] This is equivalent to saying that $\wtk{f}{\ell} = \wtk{f}{0} \cdot (-1)^{\w(\ell)}$ for any $\ell \preceq n$.
	Furthermore, these solutions do not satisfy \eqref{Eq_t=2}, which implies that there exists no WAPB function $f$ with $\corr(f) = 2$.
\end{proof}

%\begin{proposition} Let $n\in \N^*$ with $\w(n)=3$. Then there exist WAPB functions $f$ with $\corr(f)=2$, and the
%	restricted Walsh vector $\rwv{f}$ is  given by
%	\[
%	\wtk{f}{\ell} = (-1)^{\w(\ell)}, \forall \, \ell \preceq n.
%	\]
%	Furthermore, there exists no WAPB function $f$ with $\corr(f)=3$.
%\end{proposition}
\begin{proposition}\label{prop:t=3} Let $n\in \N^*$ with $\w(n)=3$. Then any WAPB function $f$ has $\corr(f)\leq 2$.
	Furthermore, the equality is reached if and only if the restricted Walsh vector $\rwv{f}$ is given by
	\[
	\wtk{f}{\ell} =   \wtk{f}{0} \cdot (-1)^{\w(\ell)}, \forall \, \ell \preceq n.
	\]
	%	Furthermore, there exists no WAPB function $f$ with $\corr(f)=2$.
\end{proposition}
\input{proof_t3.tex}

%\begin{proposition}\label{prop:WAPB2}
%
%	Let $k_1<k_2\in \N$ and $n=2^{k_1}+2^{k_2}$, if $f$ is an $n$-variable WAPB function then $f$ is at most $1$-corrector and not $2$-resilient.
%\end{proposition}
%\begin{proof}
%	From Proposition~\ref{thm:WalsCorr} $f$ is $1$-corrector if for $k=0$ and $k=1$:
%	\begin{equation}\label{eq:wapb2}
%	\sum_{\ell=0}^{n} \wtk{f}{\ell} \, \kraw{k}{\ell}{n}=0
%	\end{equation}
%	and $2$ corrector if additionally the same equation holds for $k=2$.
%
%	Using Property~\ref{prop:WAPBWalsh} the only restricted Walsh transform coefficient that are not null are the ones for $k\in\{0,2^{k_1},2^{k_2},2^{k_1}+2^{k_2}=n\}$. It allows to simplify Equation~\ref{eq:wapb2}:
%	\begin{equation}\label{eq:wapb2simple}
%	a \kraw{k}{0}{n} + b \kraw{k}{2^{k_1}}{n} + c \kraw{k}{2^{k_2}}{n} + d \kraw{k}{n}{n}=0,
%	\end{equation}
%	where $a,b,c,d \in \{\pm 1\}^4$.
%
%	Since $ \kraw{0}{\ell}{n}=1$ for all $\ell$, Equation~\ref{eq:wapb2simple} for $k=0$ leads to the equation $a+b+c+d=0$, that is two of them equal $-1$ and two of them equal $1$.
%
%	Since $ \kraw{1}{\ell}{n}=n-2\ell$, Equation~\ref{eq:wapb2simple} for $k=1$ leads to the following equation:
%	\begin{equation*}
%	a n+b (n-2^{k_1+1}) +c (n-2^{k_2+1}) -d n=0,
%	\end{equation*}
%	equivalent to:
%	\begin{equation}\label{eq:wapb2simple2}
%	(a-d+b+c) n= b 2^{k_1+1}) +c 2^{k_2+1}.
%	\end{equation}
%	We remark that if $a$ and $d$ have opposite sign, it implies $b$ and $c$ also to satisfy Equation~\ref{eq:wapb2simple}.
%	In this case, Equation~\ref{eq:wapb2simple2} becomes $\pm2n= \pm (2^{k_1+1} - 2^{k_2+1})$ which is impossible.
%	Nevertheless, if $a=d$ it implies $b=c=-a$ and in this case the equation becomes $\pm 2n = \pm (2^{k_1+1} + 2^{k_2+1})=\pm 2n$.
%	This shows that there exist $(2^{k_1}+2^{k_2})$-variable WAPB functions that are $1$-corrector.
%
%
%	Since $ \kraw{2}{\ell}{n}=\ell^2 -2 n \ell + \binom{n}{2}$, the solutions satisfying Equation~\ref{eq:wapb2simple2} lead to the following equation:
%	\begin{equation}\label{eq:wapb2simple3}
%	\pm \binom{n}{2} \mp \left(2^{2k_1} -2n2^{k_1} + \binom{n}{2} \right) \mp \left(2^{2k_2} -2n2^{k_2} + \binom{n}{2} \right) \pm \left(-n^2 + \binom{n}{2}\right)=0.
%	\end{equation}
%	Equation~\ref{eq:wapb2simple3} simplifies to:
%	%\[2^{2k_1} -2n2^{k_1} + 2^{2k_2} -2n2^{k_2} +n^2= 0 \]
%	\begin{align*}
%	0&=2^{2k_1} -2n2^{k_1} + 2^{2k_2} -2n2^{k_2} +n^2\\
%	&=2^{2k_1} + 2^{2k_2} -2n(2^{k_1}+2^{k_2}) +n^2 = 2^{2k_1} + 2^{2k_2} -n^2\\
%	&= -2^{k_1+k_2+1}.
%	\end{align*}
%	Since $-2^{k_1+k_2+1}$ cannot be null, there is no solution in $\{\pm1\}^4$ satisfying Equation~\ref{eq:wapb2} for all $k\in[0,2]$, hence there exists no $(2^{k_1}+2^{k_2})$-variable WAPB function that is $2$-corrector, nor $2$-resilient.
%
%
%
%\end{proof}
%
%



\subsection{Correction order of $n$-variable WAPB functions when $\w(n)>3$}

We shall consider general cases by following the discussion for the cases where $\w(n)=2$ and $\w(n)=3$.
In order to discuss the linear systems in a unified way, we need the following lemma.

\begin{lemma}\label{lem:Represention_Equations}
	For $1\leq u \leq t$, the equation $\sum_{\ell \preceq n } \ell^uy_{\ell}  = 0$ can be re-written as
	\begin{equation}\label{key}
	\sum_{s=1}^t\sum\limits_{\substack{\{j_1,\dots, j_s\} \subseteq [t] \\ u_{j_1}+\cdots+ u_{j_s}=u \\  u_{j_1},\dots,u_{j_s}\geq 1}}  \frac{u!}{u_{j_1}!\cdots u_{j_s}!} \left(  \sum_{\substack{\{i_{j_1},\dots, i_{j_s}\} \subseteq supp(\ell)   \\ \ell\preceq n }}  y_{\ell} \right)  x_{j_1}^{u_{j_1}}\dots x_{j_s}^{u_{j_s}},
	\end{equation} where $[t]$ denotes the set $\{1,2,\dots, t\}$.
\end{lemma}

\begin{proof}
Note that the expansion of $(x_1+\cdots + x_s)^u$ is given by
\[
(x_1+\cdots + x_s)^u = \sum\limits_{\substack{u_1+\cdots + u_s = u\\ u_1,\dots, u_s\geq 0}} \frac{u!}{u_1!\cdots u_s!}x_1^{u_1}\dots x_s^{u_s},
\] where $ \frac{u!}{u_1!\cdots u_s!}$ is the multinomial coefficient.
In the above sum $(u_1,\dots, u_s)$ can be seen as a non-negative partition of the integer $u$. For simplicity, we denote by $P_s(u)$ the set of all such partitions of $u$.
Observe that for any $(u_1,\dots, u_s)\in P_s(u)$, the integers $u_1,\dots, u_s, 0$ form an $(s+1)$-tuple in $P_{s+1}(u)$. This implies the inclusive relation
$$
P_s(u) \subset P_{s+1}(u), \quad s = 1, 2, \dots.
$$
%This indicates that all terms in the sum $(x_1+\cdots + x_s)^u = \sum_{(u_1,\dots, u_s)\in P_s(u)} x_1^{u_1}\dots x_s^{u_s}$
%are included in the sum $(x_1+\cdots + x_s+x_{s+1})^u = \sum_{(u_1,\dots, u_s,u_{s+1})\in P_{s+1}(u)} x_1^{u_1}\dots x_s^{u_s}x_{s+1}^{u_{s+1}}$.
%For instance, take $u=2$ and $s=2$, one has $$\begin{array}{c}
%(x_1+x_2)^2 = {2 \choose 2,0}x_1^2x_2^0 +{2 \choose 0,2}x_1^0x_2^2 + {2 \choose 1,1}x_1^1x_2^1 = x_1^2 + x_2^2 + 2x_1x_2 \end{array}$$
%and
%$$
%\begin{aligned}
%(x_1+x_2+x_3)^2 & = {2 \choose 2,0,0}x_1^2x_2^0x_3^0 + {2 \choose 0,2,0}x_1^0x_2^2x_3^0 + {2 \choose 0,0,2}x_1^0x_2^0x_3^2
%\\& + {2 \choose 1,1,0}x_1^1x_2^1x_3^0 + {2 \choose 0,1,1}x_1^0x_2^1x_3^1 + {2 \choose 9,1,1}x_1^0x_2^1x_3^1
%\\&= x_1^2+x_2^2 +x_3^2 + 2x_1x_2 + 2x_1x_3 + 2x_2x_3.
%\end{aligned}$$
On the other hand, for an $(s+1)$-tuple $(y_1,\dots, y_{s+1})$ in $P_{s+1}(u)$ with (at) least one zero coordinate, it will degenerate to an $s$-tuple in $P_s(u)$ after one zero coordinate is removed.
Hence, for $s\leq u$, we can partition the set $P_{s}(u)$ as
\[
P_{s}(u) = P^*_{s}(u) \sqcup P^*_{s-1}(u) \sqcup \cdots \sqcup P^*_1(u),
\] where $P^*_{r}(u)$ contains those $r$-tuples $(u_1,\dots, u_{r})$ with $u_1,\dots, u_{r} \geq 1$.

Now we consider the expansion of the sum $\sum_{\ell \preceq n } y_{\ell} \ell^u = 0$ with $n=2^{i_1}+\cdots + 2^{i_t}$ and $u>0$. By denoting $x_j=2^{i_j}$ and re-arranging the terms in its expansions, we obtain
\begin{equation}\label{key}
\begin{aligned}
\sum_{\ell \preceq n } \ell^u y_{\ell}  & = \sum_{s=1}^t \sum_{\substack{supp(\ell) = \{i_{j_1},\dots, i_{j_s}\} \\ \{j_1,\dots, j_s\} \subseteq [t] \\ }}  (x_{j_1}+\dots + x_{j_s})^u y_\ell
\\&= \sum_{s=1}^t \sum_{\substack{supp(\ell) = \{i_{j_1},\dots, i_{j_s}\} \\ \{j_1,\dots, j_s\} \subseteq [t] \\ }}  y_\ell \sum\limits_{(u_1,\dots, u_s) \in P_s(u)} \frac{u!}{u_{j_1}!\cdots u_{j_s}!} x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}}
\\& =  \sum_{s=1}^t\sum\limits_{\substack{supp(\ell) = \{i_{j_1},\dots, i_{j_s}\}  \\ \{j_1,\dots, j_s\} \subseteq [t] \\ (u_{j_1},\dots, u_{j_s})\in P_s(u)}} \frac{u!}{u_{j_1}!\cdots u_{j_s}!} y_\ell   x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}}
\end{aligned}
\end{equation} where the last equality is obtained by re-arranging the summands for $s=1,\dots, t$ according to the partition $P_{s}(u) = P^*_{s}(u) \sqcup P^*_{s-1}(u) \sqcup \cdots \sqcup P^*_1(u)$.
\end{proof}

\begin{example} \label{Ex1}
	Assume $supp(n)=\{i_1,i_2,i_3\}$ with $t= 3$ and $u=2$,
	we have
	\begin{equation*}
	\begin{aligned}
	\sum_{\ell \preceq n } \ell^2 y_\ell &= \sum_{s=1}^t\sum\limits_{\substack{\{j_1,\dots, j_s\} \subseteq [t] \\ (u_{j_1},\dots, u_{j_s})\in P^*_s(u)}} {u \choose u_{j_1},\dots, u_{j_s}} \left(  \sum_{\substack{\{i_{j_1},\dots, i_{j_s}\} \subseteq supp(\ell)   \\ \ell \preceq n }}  y_k \right)  x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}}
	\\&=\sum\limits_{\substack{j\in [3] \\ u_j=2}} {2 \choose u_j}  \left(  \sum_{\substack{ \{i_j\} \subseteq supp(\ell)\\ \ell\preceq n}}  y_\ell \right) x_{j}^2 + \sum\limits_{\substack{{j_1,j_2}\in [3] \\ u_{j_1}=u_{j_2}=1}} {2 \choose u_{j_1},u_{j_2}}  \left(  \sum_{\substack{ \{i_{j_1},i_{j_2}\} \subseteq supp(\ell)\\ \ell\preceq n}}   y_\ell \right) x_{j_1}x_{j_2}
	\\& = \sum_{j=1}^3 \left(  \sum_{2^{i_j}\preceq \ell \preceq n}  y_\ell \right) x_{j}^2  +  2\sum\limits_{{j_1,j_2}\in [3]}  \left(  \sum_{ 2^{i_{j_1}}+2^{i_{j_2}} \subseteq \ell\preceq n}   y_\ell \right) x_{j_1}x_{j_2},
	\end{aligned}
	\end{equation*}
	where  the second equality has only two summations due to the fact that $P^*_{t}(u) = \emptyset$ when $t>u$. Denoting $y_\ell$ for $\ell = b_12^{i_1}+b_22^{i_2}+b_32^{i_3}$ as $y_{b_1b_2b_3}$ with $b_1,b_2,b_3\in \{0,1\}$,
	we obtain the following expansion
	\begin{align*}
	\sum_{k \preceq n } y_kk^2
	&= (y_{100}+y_{110}+y_{101}+y_{111}) x_1^2  + (y_{010}+y_{110}+y_{011}+y_{111}) x_2^2  + (y_{001}+y_{101}+y_{011}+y_{111}) x_3^2
	\\ & + 2 \left((y_{110}+y_{111}) x_1x_2 + (y_{101}+y_{111})x_1x_3 + (y_{011}+y_{111})x_2x_3 \right)
	\end{align*}
	where $x_1 = 2^{i_1}, x_2 = 2^{i_2}, x_3 = 2^{i_3} $.
\end{example}


Recall that a sequence of integers $A$ is said to be a $B_h$ sequence if the sums of $h$ integers from $A$, i.e.,
\[
s =a_1 + \cdots + a_h, a_1\leq \cdots \leq a_h, a_k \in A
\] are all distinct \cite{cilleruelo2017}. From the definition of $B_h$ sequence, we see that a $B_h$ sequence is also a $B_k$ set for integers $k$ with $2\leq k<h$
(since any two sums of $k$ elements can be seen as two sums of $h$ elements where the last $h-k$ terms are exactly the same).

Furthermore, we shall call a sequence $A$ an $m$-gap $B_h$ sequence if $A$ is a $B_h$ sequence and 
\begin{equation}\label{Eq_m-gap_sidon}
\min \left\{ |\sum_{i=1}^ha_i - \sum_{i=1}^ha'_i|\,:\, (a_1,\dots, a_h)\neq (a'_1,\dots, a'_h) \in A^h,  a_1\leq \cdots \leq a_h, a'_1\leq \cdots \leq a'_h \right\} =m.
\end{equation}
Given a $B_h$ sequence $A$, it is easily seen that the set $tA = \{ m \cdot a : a \in A \}$ is an $m$-gap $B_h$ sequence.
\clnote{Martin: pls refine the proof with the new condition and provide an example and remark of $B_t$ sets based on the algorithm in \cite{cilleruelo2017}. }
\begin{proposition}Let $n\in \N^*$ with $n=2^{i_1}+2^{i_2}+\cdots +2^{i_t}$ with $t>3$ and $i_1<\dots < i_t$.
	 Suppose $[i_1,\dots, i_t]$ forms a $t$-gap $B_{t-1}$ sequence.
	Then any $n$-variable WAPB function $f$ has $\corr(f)\leq t-1$. Furthermore,
	the equality is reached if and only if the restricted Walsh transforms
	$\rwv{f}$ is given by
	$$
	\wtk{f}{\ell} = \wtk{f}{0} \cdot (-1)^{\w(\ell)}, \forall \, \ell \preceq n.
	$$
\end{proposition}
\input{proof_inf_family.tex}

\begin{conjecture}\label{conj:wapb-corr}
	Let $n\in \N^*$ with $\w(n)=t$. Then
	there exist WAPB functions $f$ with $\corr(f)=t-1$ and
	restricted Walsh transforms $\rwv{f}$ are uniquely given by
	\[
	\wtk{f}{\ell} = (-1)^{\w(\ell)}, \forall \, \ell \preceq n,
	\]  Furthermore,
	there exists no WAPB function $f$ with $\corr(f)=t$.
\end{conjecture}

\mgnote{Broken reference below. Didn't find which one you refered to.}
\begin{remark}
	We can see the proofs of Theorem~\ref{thm:WPB} and Proposition~\ref{prop:WAPB2} as particular cases of a more general result: \textit{Let $f$ be an $n$-variable WAPB function, then $f$ is at most $(\w(n)-1)$-corrector and cannot be $(\w(n))$-corrector}, where we prove it by considering relations on Krawtchouk polynomials of degree at most $\w(n)$.

	Increasing the Hamming weight of one doubles the number of non null restricted Walsh transform coefficients and increases by one the degree of the last polynomial to consider, that is why we do not extend the proof strategy for $n$ of higher Hamming weights.
	Regarding the resilience bound, we know that for all $n$ there exist WAPB functions with resilience order $\w(n)-1$: for example the ones obtained by direct sum of WPB functions in $2^{k_i}$ variables~\cite{DAM:ZhuSu22} when we write $n$ as $n=\sum_{i=1}^{\w(n)} 2^{k_i}$ where $k_1<\dots<k_{\w(n)}$.
	Since these functions are the direct sum of $\w(n)$ balanced functions their resilience order is at least $\w(n)-1$.
\end{remark}

\clnote{Add experimental results}
\input{experimental_results.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\section{$t$-corrector and Restricted Walsh Transform}\label{sec:corr}
%
%
%
%We rewrite the $t$-corrector property using the notation of restricted Walsh transform.
%
%
%\begin{proposition}\label{thm:WalsCorr}
%	Let $n\in \N^*$ and $t\in \N$ such that $t\le n$. A Boolean function $f\in \Bn{n}$ is a $t$-corrector if and only if its restricted Walsh transform satisfies
%	\begin{equation}\label{Eq_RWT}
%	\sum_{\ell=0}^{n} \wtk{f}{\ell} \, \kraw{k}{\ell}{n}=0 \quad \text{ for } k=0,1,\dots, t.
%	\end{equation}
%
%
%%\begin{proposition}\label{thm:WalsCorr}
%%	Let $n\in \N^*$ and $t\in \N$ such that $t\le n$. A Boolean function $f\in \Bn{n}$ is a $t$-corrector if the following holds on its restricted Walsh transform:
%%	\begin{itemize}
%%		\item If $n$ is odd: for $0\le k \le t$,
%%		\[\sum_{a\in \Ekn{k}{n}} \wt{f}(a)=\sum_{\ell=0}^{(n-1)/2} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell})=0.\]
%%	\item If $n$ is even: for $0\le k \le t$,
%%		\[\sum_{a\in \Ekn{k}{n}} \wt{f}(a)=\wtk{f}{n/2} \, \kraw{k}{n/2}{n}+ \sum_{\ell=0}^{n/2-1} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell})=0.\]
%%	\end{itemize}
%
%
%
%
%\end{proposition}
%\begin{proof}
%
%%We denote by $A_k$ the quantity $A_k=\sum_{a\in \F_2^n \atop{\w(a)=k}} \wt{f}(a)$.
%%From Definition~\ref{def:corr}, $f$ is a $t$-corrector if $A_k=0$ for $k\in [0,t]$.
%%\[A_k=\sum_{a\in \F_2^n \atop{\w(a)=k}} \wt{f}(a).\]
%Note that
%\begin{align*}
%\sum_{a\in \Ekn{k}{n}} \wt{f}(a)&=\sum_{a\in \Ekn{k}{n}} \sum_{x\in \F_2^n} (-1)^{f(x)+a \cdot x}\\
%&= \sum_{x\in \F_2^n} (-1)^{f(x)}  \left(\sum_{a\in \Ekn{k}{n}}(-1)^{a \cdot x}\right)\\
%&=\sum_{\ell=0}^{n} \sum_{x\in \Ekn{\ell}{n}} (-1)^{f(x)}  \left(\sum_{a\in \Ekn{k}{n}}(-1)^{a \cdot x}\right)\\
%&=\sum_{\ell=0}^{n} \sum_{x\in \Ekn{\ell}{n}} (-1)^{f(x)} \,  \kraw{k}{\ell}{n}\\
%&=\sum_{\ell=0}^{n} \wtk{f}{\ell} \, \kraw{k}{\ell}{n},
%\end{align*}
%where the last second equality follows from \eqref{Eq_K_rwt}.
%The desired statement is then proved by Definition~\ref{def:corr}.
%\end{proof}
%
%%Using Property~\ref{prop:Kr}, when $n$ is odd we obtain:
%%\[A_k=\sum_{\ell=0}^{(n-1)/2} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell}). \]
%%When $n$ is even we obtain:
%%\[A_k=\wtk{f}{n/2} \, \kraw{k}{n/2}{n}+ \sum_{\ell=0}^{n/2-1} \kraw{k}{\ell}{n} \, ( \wtk{f}{\ell} + (-1)^k \wtk{f}{n-\ell}). \]
%%It allows to conclude.
%
%
%
%%\begin{corollary}
%%
%%\end{corollary}
%
%
%
%
%%\section{WPB functions and corrector order}
%\section{Correction order of W(A)PB Functions}
%
%\subsection{Characterizations in terms of Krawtchouk and Vandemonde matrices}
%
%Following from Proposition~\ref{prop:WAPBWalsh}, we reformulate WAPB functions of correction order $t$ in terms of Krawtchouk polynomials.
%
%\begin{definition}\label{def:restWalshVect}
%	Let $n\in \N^*$ and $f\in \BN$, we define its restricted Walsh vector, denoted by $\rwv{f}$, in $\Z^{n+1}$ as:
%	\[\rwv{f}=(\wtk{f}{0},\wtk{f}{1},\cdots,\wtk{f}{n-1},\wtk{f}{n})^\intercal\]
%
%\end{definition}
%
%
%\begin{definition}\label{def:KrMat}
%	Let $n\in \N^*$ and $t\in \N$ such that $t\le n$, we define the Krawtchouk matrix $\matK$ of order $(n+1)$ as:
%	\[\forall k \in [0,n], \ell \in [0,n], \quad \matK_{k,\ell}=\kraw{k}{\ell}{n},\]
%	and denote by $\matK^{(t)}$ the submatrix formed by the leading $t$ rows of $\matK$.
%
%	%	$\KrM{n}{k}\in 	\Z^{(n+1)\times (k+1)}$ as:
%
%
%\end{definition}
%
%With these notations, using the development of Proposition~\ref{thm:WalsCorr} we get that $f$ is a $t$-corrector if and only if:
%\begin{equation}\label{Eq_t-corrector}
%\matK^{(t)}\cdot \rwv{f}=\textbf{0}_t^\intercal.
%\end{equation}
%The following theorem provides an interesting connection between the Krawtchouk matrix and the Vandemonde matrix. This connection facilitates the study of the above equation.
%
%\begin{theorem}\label{Th_K_V_matrices}
%	Let $\matK$ be the Krawtchouk matrix and $\matV$ be the Vandermonde matrix given by $V_{k,\ell} =\ell^k$ with $0\leq k,\ell\leq n$ indexing the rows and columns, respectively.
%	For $0\leq k\leq n$, let
%	\[
%	\alpha_k = -\frac{k}{2}, \beta_k = \frac{n}{2}, \gamma_k = -\frac{n-k}{2},
%	\]
%	and for $1\leq r\leq n$ define $r\times(r+1)$ matrices $H_r$ as follows:
%	\begin{equation}\label{Eq_H}
%	%         H_1 = \begin{bmatrix}
%	%     \beta_0 & \alpha_1
%	% \end{bmatrix},
%	% \quad
%	% H_2 =  \begin{bmatrix}
%	%            \beta_0 & \alpha_1 \\
%	%            \gamma_0 & \beta_1 & \alpha_2
%	%        \end{bmatrix},
%	% \cdots,
%	H_{r} = \begin{bmatrix}
%	\beta_0 & \alpha_1 &  & & &\\
%	\gamma_0 & \beta_1 & \alpha_2 & & &\\
%	& \gamma_1 & \beta_2 & \alpha_3 &  &
%	\\
%	& & \ddots & \ddots & \ddots &\\
%	& & & \gamma_{r-2} &\beta_{r-1} & \alpha_{r}
%	\end{bmatrix}.
%	\end{equation}
%	Then we have \[
%	\matM \cdot \matK = \matV,
%	\]
%	where $\matM$ is an $(n+1)\times(n+1)$ lower triangular matrix whose rows are given by the following recursion:
%	\begin{equation}\label{Eq_Matrix_M}
%	% \begin{array}{rcl}
%	%     \matM_{0,0} &=& 1 \\
%	%     \matM_{1,[0,1]} &=& \matM_{0,[0,0]}H_1 \\
%	%     \matM_{2,[0,2]} &=& \matM_{1,[0,1]} H_2\\
%	%     % & \vdots & \\
%	%     % \matM_{r+1,[0,r+1]} &=& \matM_{r,[0,r]} H_r
%	%     \\
%	%     &\vdots & \\
%	%     \matM_{n,[0,n]} & = & \matM_{n-1,[0,n-1]}H_n,
%	% \end{array}
%	\matM_{0,0} = 1,\quad \matM_{r,[0,r]} = \matM_{r-1,[0,r-1]} H_r \text{ for } r = 1, 2,\dots, n,
%	\end{equation}
%	where $\matM_{r,[0,r]} = [M_{r,0},\dots, M_{r,r}]$ denotes the leading $(r+1)$ entries in the $r$-th row of $M$.
%
%
%\end{theorem}
%
%Let $\matM_{[t]}$ be the upper-left block of size $t$ in the matrix $\matM$.
%It follows from \eqref{Eq_Matrix_M} that $\matM_{[t]}$ is invertible.
%Then it follows from Theorem~\ref{Th_K_V_matrices} that
%\[
%\matM_{[t]} \cdot \matK^{(t)} = \matV^{(t)},
%\]where $\matV^{(t)}$ is the submatrix formed by the leading $t$ rows of $\matV$.
%Therefore,  a Boolean function $f$ is a $t$-corrector if and only if its restricted Walsh transform $\rwv{f}$
%satisfies the following system of equations:
%\begin{equation}\label{Eq_Vandemonde_system}
%\matV^{(t)} \cdot \rwv{f} = \mathbf{0}_t^\intercal.
%\end{equation}
%
%Furthermore, for a WAPB function $f$, we have $\rwv{f}\in \{-1,0,1\}^{n+1}$ from Property~\ref{prop:WAPBWalsh}. Moreover, since the number of nonzero values corresponds to the odd parity of the associate binary coefficient, we have $\w(\rwv{f})=2^{\w(n)}$, and the nonzero coefficients in $\rwv{f}$ are the $\ell$-th entries such that $\ell\preceq n$.
%Therefore, we have the following result:
%
%\begin{proposition}
%	Let $\matW$ denote the $t\times 2^t$ submatrix of $\matV^{(t)}$ formed by the $\ell$-th column in $\matV^{(t)}$ with $\ell \preceq n$.
%	Then there is a one-to-one correspondence between WAPB functions of correction order $t$ and the solutions $\mathbf{y}=(y_0,y_1,\dots, y_{2^t-1})^\intercal \in \{\pm 1\}^{2^t}$ of the following
%	system of equations:
%	\[
%	\matW \cdot \mathbf{y} = \mathbf{0}_{t}^{\intercal}.
%	\]
%\end{proposition}
%
%
%\subsection{WPB functions are balanced and not $1$-resilient}
%The reformulation of $t$-corrector is sufficient to show that WPB functions are $0$-corrector and not $1$-corrector, which also allows to status on their resilience order.
%
%\begin{theorem}\label{thm:WPB}
%	Let $m\in \N^*$ and $n=2^m$, if $f$ is an $n$-variable WPB function then $f$ is $0$-corrector, $f$ is not $1$-corrector, $f$ is $0$-resilient and not $1$-resilient.
%\end{theorem}
%\begin{proof}
%	By definition (Definition~\ref{def:WPB}) a WPB function is balanced, hence $0$-corrector and $0$-resilient.
%	To show that $f$ is not $1$-corrector we show the values of its restricted Walsh transform do not satisfy the characterization of Proposition~\ref{thm:WalsCorr}.
%
%	Using Proposition~\ref{thm:WalsCorr} and Property~\ref{prop:Kr}, for $n=2^m$ we have:
%	\[\sum_{a\in \Ekn{1}{n}} \wt{f}(a)=\wtk{f}{n/2} \, \kraw{1}{n/2}{n}+ \sum_{\ell=0}^{n/2-1} \kraw{1}{\ell}{n} \, ( \wtk{f}{\ell} - \wtk{f}{n-\ell}).\]
%	Since $f$ is WPB, using Property~\ref{prop:WAPBWalsh} we obtain:
%	\[\sum_{a\in \Ekn{1}{n}} \wt{f}(a)=0+2\kraw{1}{0}{n}=2n\ne 0,\]
%	hence $f$ is not $1$-corrector by Proposition~\ref{thm:WalsCorr}. Since $f$ is not $1$-corrector it implies $f$ is not $1$-resilient.
%\end{proof}
%
%We recall that the WAPB functions when $n=2^m$ are either of the form $f$ or $1+f$ with $f\in \WPB{m}$, hence all $2^m$-variable WAPB functions are $0$-resilient and not $1$-resilient.
%
%In the subsequent sections we shall discuss the cases where $n$ has higher Hamming weights.
%
%\subsection{WAPB functions of correction order $t\geq 2$}
%
%
%
%
%\subsection{Correction order of WAPB functions in $n=2^{k_1} + 2^{k_2}$ variables}
%
%We can extend the bound of the correction order to $\WAPB{n}$ when $\w(n)=2$, using the Krawtchouk polynomials of degree $2$.
%
%\begin{proposition}\label{prop:WAPB2}
%	Let $k_1<k_2\in \N$ and $n=2^{k_1}+2^{k_2}$, if $f$ is an $n$-variable WAPB function then $f$ is at most $1$-corrector and not $2$-resilient.
%\end{proposition}
%\begin{proof}
%	From Proposition~\ref{thm:WalsCorr} $f$ is $1$-corrector if for $k=0$ and $k=1$:
%	\begin{equation}\label{eq:wapb2}
%	\sum_{\ell=0}^{n} \wtk{f}{\ell} \, \kraw{k}{\ell}{n}=0
%	\end{equation}
%	and $2$ corrector if additionally the same equation holds for $k=2$.
%
%Using Property~\ref{prop:WAPBWalsh} the only restricted Walsh transform coefficient that are not null are the ones for $k\in\{0,2^{k_1},2^{k_2},2^{k_1}+2^{k_2}=n\}$. It allows to simplify Equation~\ref{eq:wapb2}:
%	\begin{equation}\label{eq:wapb2simple}
%a \kraw{k}{0}{n} + b \kraw{k}{2^{k_1}}{n} + c \kraw{k}{2^{k_2}}{n} + d \kraw{k}{n}{n}=0,
%\end{equation}
%where $a,b,c,d \in \{\pm 1\}^4$.
%
%Since $ \kraw{0}{\ell}{n}=1$ for all $\ell$, Equation~\ref{eq:wapb2simple} for $k=0$ leads to the equation $a+b+c+d=0$, that is two of them equal $-1$ and two of them equal $1$.
%
%Since $ \kraw{1}{\ell}{n}=n-2\ell$, Equation~\ref{eq:wapb2simple} for $k=1$ leads to the following equation:
%\begin{equation*}
%a n+b (n-2^{k_1+1}) +c (n-2^{k_2+1}) -d n=0,
%\end{equation*}
%equivalent to:
%\begin{equation}\label{eq:wapb2simple2}
% (a-d+b+c) n= b 2^{k_1+1}) +c 2^{k_2+1}.
%\end{equation}
%We remark that if $a$ and $d$ have opposite sign, it implies $b$ and $c$ also to satisfy Equation~\ref{eq:wapb2simple}.
%In this case, Equation~\ref{eq:wapb2simple2} becomes $\pm2n= \pm (2^{k_1+1} - 2^{k_2+1})$ which is impossible.
%Nevertheless, if $a=d$ it implies $b=c=-a$ and in this case the equation becomes $\pm 2n = \pm (2^{k_1+1} + 2^{k_2+1})=\pm 2n$.
%This shows that there exist $(2^{k_1}+2^{k_2})$-variable WAPB functions that are $1$-corrector.
%
%
%Since $ \kraw{2}{\ell}{n}=\ell^2 -2 n \ell + \binom{n}{2}$, the solutions satisfying Equation~\ref{eq:wapb2simple2} lead to the following equation:
%\begin{equation}\label{eq:wapb2simple3}
%\pm \binom{n}{2} \mp \left(2^{2k_1} -2n2^{k_1} + \binom{n}{2} \right) \mp \left(2^{2k_2} -2n2^{k_2} + \binom{n}{2} \right) \pm \left(-n^2 + \binom{n}{2}\right)=0.
%\end{equation}
%Equation~\ref{eq:wapb2simple3} simplifies to:
%%\[2^{2k_1} -2n2^{k_1} + 2^{2k_2} -2n2^{k_2} +n^2= 0 \]
%\begin{align*}
%0&=2^{2k_1} -2n2^{k_1} + 2^{2k_2} -2n2^{k_2} +n^2\\
%&=2^{2k_1} + 2^{2k_2} -2n(2^{k_1}+2^{k_2}) +n^2 = 2^{2k_1} + 2^{2k_2} -n^2\\
%&= -2^{k_1+k_2+1}.
%\end{align*}
%Since $-2^{k_1+k_2+1}$ cannot be null, there is no solution in $\{\pm1\}^4$ satisfying Equation~\ref{eq:wapb2} for all $k\in[0,2]$, hence there exists no $(2^{k_1}+2^{k_2})$-variable WAPB function that is $2$-corrector, nor $2$-resilient.
%
%
%
%\end{proof}
%
%
%\begin{remark}
%We can see the proofs of Theorem~\ref{thm:WPB} and Proposition~\ref{prop:WAPB2} as particular cases of a more general result: \textit{Let $f$ be an $n$-variable WAPB function, then $f$ is at most $(\w(n)-1)$-corrector and cannot be $(\w(n))$-corrector}, where we prove it by considering relations on Krawtchouk polynomials of degree at most $\w(n)$.
%
%Increasing the Hamming weight of one doubles the number of non null restricted Walsh transform coefficients and increases by one the degree of the last polynomial to consider, that is why we do not extend the proof strategy for $n$ of higher Hamming weights.
%Regarding the resilience bound, we know that for all $n$ there exist WAPB functions with resilience order $\w(n)-1$: for example the ones obtained by direct sum of WPB functions in $2^{k_i}$ variables~\cite{DAM:ZhuSu22} when we write $n$ as $n=\sum_{i=1}^{\w(n)} 2^{k_i}$ where $k_1<\dots<k_{\w(n)}$.
%Since these functions are the direct sum of $\w(n)$ balanced functions their resilience order is at least $\w(n)-1$.
%
%
%
%
%\end{remark}



%
%
%\section{WAPB Functions and Corrector Order}
%
%\pmnote{proposed roadmap:
%
%\begin{itemize}
%	\item definitions to connect it to the matrix
%	\item from Krawtchouk matrix to the powers
%	\item solution for $\w(n)$-1, add link to PTE problem. add note on the existing WAPB that hare $\w(n)-1$-resilient.
%\end{itemize}
%}
%
%Reformulation.
%
%\begin{definition}\label{def:restWalshVect}
%Let $n\in \N^*$ and $f\in \BN$, we define its restricted Walsh vector, denoted by $\rwv{f}$, in $\Z^{n+1}$ as:
%\[\rwv{f}=(\wtk{f}{0},\wtk{f}{1},\cdots,\wtk{f}{n-1},\wtk{f}{n})\]
%
%\end{definition}
%
%
%\begin{definition}\label{def:KrMat}
%	Let $n\in \N^*$ and $k\in \N$ such that $k\le n$, we define the Krawtchouk matrix
%	$\KrM{n}{k}\in 	\Z^{(n+1)\times (k+1)}$ as:
%	\[\forall i \in [0,n], j\in [0,k], \quad \KrM{n}{k}_{i,j}=\kraw{j}{i}{n}.\]
%
%\end{definition}
%
%With these notations, using the development of Proposition~\ref{thm:WalsCorr} we get that $f$ is a $t$-corrector if and only if:
%\[\rwv{f} \cdot \KrM{n}{t}=0_t.\]
%
%For a WAPB function $f$, we have $\rwv{f}\in \{-1,0,1\}^{n+1}$ from Property~\ref{prop:WAPBWalsh}. Moreover, since the number of nonzero values corresponds to the odd parity of the associate binary coefficient, we have $\w(\rwv{f})=2^{\w(n)}$, and the non null coefficients are the ones such that $k\preceq n$.
%
%
%We can prove that for $\w(n)=1$ (the case of WPB functions) the WAPB functions cannot be $1$-corrector
%(that is $\rwv{f} \cdot \KrM{n}{1}$
%$\neq 0_2$), and for
% $\w(n)=2$
%  (the case of WAPB functions in $2^r +2^s$ variables) the WAPB functions
% cannot be $2$-corrector (that is $\rwv{f} \cdot \KrM{n}{2} \ne 0_3$).
%We would like to prove or disprove that $n$-variable WAPB functions are not $\w(n)$-corrector.
%
%The results for $\w(n)=1$ and $\w(n)=2$ comes from the value of the matrix $\KrM{n}{n}$, but could we deduce more knowing that the matrix is invertible?
%
%
%
%\pmnote{
%
% WAPB in $n$ variable have $2^\w(n)$ restricted Walsh values that belongs to $\{-1,1\}$.
%
%
%  So far the best resilience order known for a WAPB function is $\w(n)-1$.
%}
%
%
%
%\subsection{Notes on the proposition}
%
%Let us ave a look on the expression of an integer at the power $r$ when we write it in binary:
%\[a^r=(\sum_{i=1}^{t} b_i 2^{k_i})^r\]
%If we develop this expression we can rewrite it as a multivariate polynomial in the $b_i$.
%I give the example for $t=2$:
%\[a^0=1, \quad a^1= b_1 2^{k_1}+ b_2 2^{k_2},\quad a^2= b_1 2^{2k_1} + b_1 b_2 2\cdot  2^{k_1+k_2} + b_2 2^{2k_2}.\]
%
%The expression will make appear all combinations of the $b_i$ having between $1$ and $r$ $b_i$s. Each one of these monomials of degree between $1$ and $r$ is associated to a coefficient, say $c_b$.
%
%Then, when we consider the $-1$ and $+1$ combinations to obtain $0$, it means we split $\F_2^t$ in two sets of size $2^{t-1}$, $S_1$ and $S_2$ such that:
%\[\sum_{b\in S_1} (\sum_{i=1}^{t} b_i 2^{k_i})^r =  \sum_{b\in S_2} (\sum_{i=1}^{t} b_i 2^{k_i})^r.\]
%
%We can verify that when $t<r$, taking $S_1$ as the set of vectors of odd Hamming weight and $S_2$ the set of vectors of even Hamming weight each term $c_b$ appears the same number of times in each sum: the monomials of degree between $1$ and $r$ are equal to $1$ the same number of times over $S_1$ than over $S_2$. It is sufficient to guarantee the equality of the two sums.
%
%When $t=r$, the situation changes: there is the monomial of degree $t$: $\prod_{i=1}^t b_i$, and this one takes the value $1$ only for one element: $1_t$. For all other monomials, they take the value $1$ on the same number of elements in $S_1$ than in $S_2$.
%Accordingly, the two sums differ from a term $c_{1_t}$.
%
%This explain why taking $S_1$ and $S_2$ as odd and even Hamming weight element work to create $t-1$-corrector that are not $t$-corrector.
%I am not sure it allows to conclude they do not exist: we could do another partition of $\F_2^t$ as $S_1$ and $S_2$ such that $|S_1|=|S_2|$ where we compensate the $c_b$s. We have that $c_{1_t}$ will appear only once, so in only one of the two sums, the total number of terms appearing is odd when $r=t$.
%
%
%
%
%
%
%
%
%
%
%\newpage
%
%\subsection*{A note on the problem}
%
%For a positive integer $n$ of Hamming weight $t\geq 2$, we denote by $supp(n)$ the set of nonzero coordinates in the binary expansion of $n$.
%For two positive integers $n, m$, we denote by $m\preceq n$ when $supp(m) \subseteq supp(n)$, and by $m\prec n$ if $supp(m) \subset supp(n)$.
%
%Given a positive integer $n$ with $supp(n) = \{i_1,\dots, i_t\}$, where $i_1<\dots<i_t$, we need to show that the system of equations
%\[
%\sum_{k \preceq n } v_k k^u = 0, \quad  u=0,\dots, r
%\] has solutions $(v_0,\dots, v_n)\in \{\pm 1\}^{2^t}$ for $r=t-1$ and has no solution for $r=t$.
%
%\begin{lemma}\label{Represention_Equations}
%	For $1\leq u \leq t$, the equation $\sum_{k \preceq n } v_k k^u = 0$ can be re-written as
%	\begin{equation}\label{key}
%	\sum_{s=1}^t\sum\limits_{\substack{\{j_1,\dots, j_s\} \subseteq [t] \\ u_{j_1}+\cdots+ u_{j_s}=u \\  u_{j_1},\dots,u_{j_s}\geq 1}}  \frac{u!}{u_1!\cdots u_s!} \left(  \sum_{\substack{\{i_{j_1},\dots, i_{j_s}\} \subseteq supp(k)   \\ k\preceq n }}  v_k \right)  x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}},
%	\end{equation} where $[t]$ denotes the set $\{1,2,\dots, t\}$.
%\end{lemma}
%
%\textbf{Proof.} Note that the expansion of $(x_1+\cdots + x_s)^u$ is given by
%\[
%(x_1+\cdots + x_s)^u = \sum\limits_{\substack{u_1+\cdots + u_s = u\\ u_1,\dots, u_s\geq 0}} \frac{u!}{u_1!\cdots u_s!}x_1^{u_1}\dots x_s^{u_s},
%\] where $ \frac{u!}{u_1!\cdots u_s!}$ is the multinomial coefficient.
%In the above sum $(u_1,\dots, u_s)$ can be seen as a non-negative partition of the integer $u$. For simplicity, we denote by $P_s(u)$ the set of all such partitions of $u$.
%Observe that for any $(u_1,\dots, u_s)\in P_s(u)$, the integers $u_1,\dots, u_s, 0$ form an $(s+1)$-tuple in $P_{s+1}(u)$. This implies the inclusive relation
%$$
%P_s(u) \subset P_{s+1}(u), quad s = 1, 2, \dots.
%$$
%%This indicates that all terms in the sum $(x_1+\cdots + x_s)^u = \sum_{(u_1,\dots, u_s)\in P_s(u)} x_1^{u_1}\dots x_s^{u_s}$
%%are included in the sum $(x_1+\cdots + x_s+x_{s+1})^u = \sum_{(u_1,\dots, u_s,u_{s+1})\in P_{s+1}(u)} x_1^{u_1}\dots x_s^{u_s}x_{s+1}^{u_{s+1}}$.
%%For instance, take $u=2$ and $s=2$, one has $$\begin{array}{c}
%%(x_1+x_2)^2 = {2 \choose 2,0}x_1^2x_2^0 +{2 \choose 0,2}x_1^0x_2^2 + {2 \choose 1,1}x_1^1x_2^1 = x_1^2 + x_2^2 + 2x_1x_2 \end{array}$$
%%and
%%$$
%%\begin{aligned}
%%(x_1+x_2+x_3)^2 & = {2 \choose 2,0,0}x_1^2x_2^0x_3^0 + {2 \choose 0,2,0}x_1^0x_2^2x_3^0 + {2 \choose 0,0,2}x_1^0x_2^0x_3^2
%%\\& + {2 \choose 1,1,0}x_1^1x_2^1x_3^0 + {2 \choose 0,1,1}x_1^0x_2^1x_3^1 + {2 \choose 9,1,1}x_1^0x_2^1x_3^1
%%\\&= x_1^2+x_2^2 +x_3^2 + 2x_1x_2 + 2x_1x_3 + 2x_2x_3.
%%\end{aligned}$$
%On the other hand, for an $(s+1)$-tuple $(v_1,\dots, v_{s+1})$ in $P_{s+1}(u)$ with (at) least one zero coordinate, it will degenerate to an $s$-tuple in $P_s(u)$ after one zero coordinate is removed.
%Hence, for $s\leq u$, we can partition the set $P_{s}(u)$ as
%\[
%P_{s}(u) = P^*_{s}(u) \sqcup P^*_{s-1}(u) \sqcup \cdots \sqcup P^*_1(u),
%\] where $P^*_{r}(u)$ contains those $r$-tuples $(u_1,\dots, u_{r})$ with $u_1,\dots, u_{r} \geq 1$.
%
%Now we consider the expansion of the sum $\sum_{k \preceq n } v_k k^u = 0$ with $n=2^{i_1}+\cdots + 2^{i_t}$ and $u>0$. By denoting $x_j=2^{i_j}$ and re-arranging the terms in its expansions, we obtain
%\begin{equation}\label{key}
%\begin{aligned}
%\sum_{k \preceq n } v_kk^u & = \sum_{s=1}^t \sum_{\substack{supp(k) = \{i_{j_1},\dots, i_{j_s}\} \\ \{j_1,\dots, j_s\} \subseteq [t] \\ }} v_k (x_{j_1}+\dots + x_{j_s})^u
%\\&= \sum_{s=1}^t \sum_{\substack{supp(k) = \{i_{j_1},\dots, i_{j_s}\} \\ \{j_1,\dots, j_s\} \subseteq [t] \\ }}  v_k \sum\limits_{(u_1,\dots, u_s) \in P_s(u)} \frac{u!}{u_{j_1}!\cdots u_{j_s}!} x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}}
%\\& =  \sum_{s=1}^t\sum\limits_{\substack{supp(k) = \{i_{j_1},\dots, i_{j_s}\}  \\ \{j_1,\dots, j_s\} \subseteq [t] \\ (u_{j_1},\dots, u_{j_s})\in P_s(u)}} \frac{u!}{u_{j_1}!\cdots u_{j_s}!} v_k   x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}}
%\\& =  \sum_{s=1}^t\sum\limits_{\substack{\{j_1,\dots, j_s\} \subseteq [t] \\ (u_{j_1},\dots, u_{j_s})\in P^*_s(u)}} \frac{u!}{u_{j_1}!\cdots u_{j_s}!} \left(  \sum_{\substack{\{i_{j_1},\dots, i_{j_s}\} \subseteq supp(k)   \\ k\preceq n }}  v_k \right)  x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}},
%\end{aligned}
%\end{equation} where the last equality is obtained by re-arranging the summands for $s=1,\dots, t$ according to the partition $P_{s}(u) = P^*_{s}(u) \sqcup P^*_{s-1}(u) \sqcup \cdots \sqcup P^*_1(u)$. \hfill$\square$
%
%\begin{example} \label{Ex1}
%	Assume $supp(n)=\{i_1,i_2,i_3\}$ with $t= 3$ and $u=2$,
%	we have
%	\begin{equation*}
%	\begin{aligned}
%	\sum_{k \preceq n } v_kk^2 &= \sum_{s=1}^t\sum\limits_{\substack{\{j_1,\dots, j_s\} \subseteq [t] \\ (u_{j_1},\dots, u_{j_s})\in P^*_s(u)}} {u \choose u_{j_1},\dots, u_{j_s}} \left(  \sum_{\substack{\{i_{j_1},\dots, i_{j_s}\} \subseteq supp(k)   \\ k\preceq n }}  v_k \right)  x_{j_1}^{u_1}\dots x_{j_s}^{u_{j_s}}
%	\\&=\sum\limits_{\substack{j\in [3] \\ u_j=2}} {2 \choose u_j}  \left(  \sum_{\substack{ \{i_j\} \subseteq supp(k)\\ k\preceq n}}  v_k \right) x_{j}^2 + \sum\limits_{\substack{{j_1,j_2}\in [3] \\ u_{j_1}=u_{j_2}=1}} {2 \choose u_{j_1},u_{j_2}}  \left(  \sum_{\substack{ \{i_{j_1},i_{j_2}\} \subseteq supp(k)\\ k\preceq n}}   v_k \right) x_{j_1}x_{j_2}
%	\\& = \sum_{j=1}^3 \left(  \sum_{2^{i_j}\preceq k\preceq n}  v_k \right) x_{j}^2  +  2\sum\limits_{{j_1,j_2}\in [3]}  \left(  \sum_{ 2^{i_{j_1}}+2^{i_{j_2}} \subseteq k\preceq n}   v_k \right) x_{j_1}x_{j_2},
%	\end{aligned}
%	\end{equation*}
%	where  the second equality has only two summations due to the fact that $P^*_{t}(u) = \emptyset$ when $t>u$. Denoting $v_k$ for $k = k_12^{i_1}+k_22^{i_2}+k_32^{i_3}$ as $v_{k_1k_2k_3}$,
%	we obtain the following expansion
%	\begin{align*}
%		\sum_{k \preceq n } v_kk^2
%		&= (v_{100}+v_{110}+v_{101}+v_{111}) x_1^2  + (v_{010}+v_{110}+v_{011}+v_{111}) x_2^2  + (v_{001}+v_{101}+v_{011}+v_{111}) x_3^2
%		\\ & + 2 \left((v_{110}+v_{111}) x_1x_2 + (v_{101}+v_{111})x_1x_3 + (v_{011}+v_{111})x_2x_3 \right)
%	\end{align*}
%	where $x_1 = 2^{i_1}, x_2 = 2^{i_2}, x_3 = 2^{i_3} $.
%\end{example}














%\section{Acknowledgments}
%The author was funded by the European Research Council (\textsf{ERC}) under the Advanced Grant program (reference number: 787390).
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\ifnum\full=0
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{alpha}
\bibliography{add}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\else
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliographystyle{alpha}
\bibliography{add}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\fi



\end{document}
